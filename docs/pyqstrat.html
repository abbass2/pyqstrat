
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyqstrat package &#8212; pyqstrat 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyqstrat" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pyqstrat-package">
<h1>pyqstrat package<a class="headerlink" href="#pyqstrat-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyqstrat.pq_utils">
<span id="pyqstrat-pq-utils-module"></span><h2>pyqstrat.pq_utils module<a class="headerlink" href="#module-pyqstrat.pq_utils" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.pq_utils.ReasonCode">
<em class="property">class </em><code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">ReasonCode</code><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#ReasonCode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class containing constants for predefined order reason codes. Prefer these predefined reason codes if they suit
the reason you are creating your order.  Otherwise, use your own string.</p>
<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.BACKTEST_END">
<code class="descname">BACKTEST_END</code><em class="property"> = 'backtest end'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.BACKTEST_END" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.ENTER_LONG">
<code class="descname">ENTER_LONG</code><em class="property"> = 'enter long'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.ENTER_LONG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.ENTER_SHORT">
<code class="descname">ENTER_SHORT</code><em class="property"> = 'enter short'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.ENTER_SHORT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.EXIT_LONG">
<code class="descname">EXIT_LONG</code><em class="property"> = 'exit long'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.EXIT_LONG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.EXIT_SHORT">
<code class="descname">EXIT_SHORT</code><em class="property"> = 'exit short'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.EXIT_SHORT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.MARKER_PROPERTIES">
<code class="descname">MARKER_PROPERTIES</code><em class="property"> = {'backtest end': {'color': 'green', 'size': 50, 'symbol': '*'}, 'enter long': {'color': 'blue', 'size': 50, 'symbol': 'P'}, 'enter short': {'color': 'red', 'size': 50, 'symbol': 'P'}, 'exit long': {'color': 'blue', 'size': 50, 'symbol': 'X'}, 'exit short': {'color': 'red', 'size': 50, 'symbol': 'X'}, 'none': {'color': 'green', 'size': 50, 'symbol': 'o'}, 'roll future': {'color': 'green', 'size': 50, 'symbol': '&gt;'}}</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.MARKER_PROPERTIES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.NONE">
<code class="descname">NONE</code><em class="property"> = 'none'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.NONE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pq_utils.ReasonCode.ROLL_FUTURE">
<code class="descname">ROLL_FUTURE</code><em class="property"> = 'roll future'</em><a class="headerlink" href="#pyqstrat.pq_utils.ReasonCode.ROLL_FUTURE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.date_2_num">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">date_2_num</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#date_2_num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.date_2_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Adopted from matplotlib.mdates.date2num so we don’t have to add a dependency on matplotlib here</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.decode_future_code">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">decode_future_code</code><span class="sig-paren">(</span><em>future_code</em>, <em>as_str=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#decode_future_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.decode_future_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a future code such as “X”, return either the month number (from 1 - 12) or the month abbreviation, such as “nov”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>future_code</strong> (<em>str</em>) – the one letter future code</li>
<li><strong>as_str</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we return the abbreviation, if not, we return the month number</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decode_future_code</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">as_str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decode_future_code</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="go">&#39;nov&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.get_empty_np_value">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">get_empty_np_value</code><span class="sig-paren">(</span><em>np_dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#get_empty_np_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.get_empty_np_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get empty value for a given numpy datatype
&gt;&gt;&gt; a = np.array([‘2018-01-01’, ‘2018-01-03’], dtype = ‘M8[D]’)
&gt;&gt;&gt; get_empty_np_value(a.dtype)
numpy.datetime64(‘NaT’)</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.get_fut_code">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">get_fut_code</code><span class="sig-paren">(</span><em>month</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#get_fut_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.get_fut_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a month number such as 3 for March, return the future code for it, e.g. H
&gt;&gt;&gt; get_fut_code(3)
‘H’</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.get_temp_dir">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">get_temp_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#get_temp_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.get_temp_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.has_display">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">has_display</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#has_display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.has_display" title="Permalink to this definition">¶</a></dt>
<dd><p>If we are running in unit test mode or on a server, then don’t try to draw graphs, etc.</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.infer_compression">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">infer_compression</code><span class="sig-paren">(</span><em>input_filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#infer_compression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.infer_compression" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers compression for a file from its suffix.  For example, given “/tmp/hello.gz”, this will return “gzip”
&gt;&gt;&gt; infer_compression(“/tmp/hello.gz”)
‘gzip’
&gt;&gt;&gt; infer_compression(“/tmp/abc.txt”) is None
True</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.infer_frequency">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">infer_frequency</code><span class="sig-paren">(</span><em>timestamps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#infer_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.infer_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns most common frequency of date differences as a fraction of days
:param timestamps: A numpy array of monotonically increasing datetime64</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-01 11:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-01 11:15:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-01 11:30:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-01 11:35:00&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[ns]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">infer_frequency</span><span class="p">(</span><span class="n">timestamps</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">0.01041667</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.is_newer">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">is_newer</code><span class="sig-paren">(</span><em>filename</em>, <em>ref_filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#is_newer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.is_newer" title="Permalink to this definition">¶</a></dt>
<dd><p>whether filename ctime (modfication time) is newer than ref_filename or either file does not exist
&gt;&gt;&gt; import time
&gt;&gt;&gt; import tempfile
&gt;&gt;&gt; temp_dir = tempfile.gettempdir()
&gt;&gt;&gt; touch(f’{temp_dir}/x.txt’)
&gt;&gt;&gt; time.sleep(0.1)
&gt;&gt;&gt; touch(f’{temp_dir}/y.txt’)
&gt;&gt;&gt; is_newer(f’{temp_dir}/y.txt’, f’{temp_dir}/x.txt’)
True
&gt;&gt;&gt; touch(f’{temp_dir}/y.txt’)
&gt;&gt;&gt; time.sleep(0.1)
&gt;&gt;&gt; touch(f’{temp_dir}/x.txt’)
&gt;&gt;&gt; is_newer(f’{temp_dir}/y.txt’, f’{temp_dir}/x.txt’)
False</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.linear_interpolate">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">linear_interpolate</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>x1</em>, <em>x2</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#linear_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.linear_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{linear_interpolate(3, 4, 8, 10, 8.9):.3f}&#39;</span><span class="p">)</span>
<span class="go">3.450</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.millis_since_epoch">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">millis_since_epoch</code><span class="sig-paren">(</span><em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#millis_since_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.millis_since_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a python datetime, return number of milliseconds between the unix epoch and the datetime.
Returns a float since it can contain fractions of milliseconds as well
&gt;&gt;&gt; millis_since_epoch(datetime.datetime(2018, 1, 1))
1514764800000.0</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.monotonically_increasing">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">monotonically_increasing</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#monotonically_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.monotonically_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the array is monotonically_increasing, False otherwise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">monotonically_increasing</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-03&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monotonically_increasing</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-02&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.nan_to_zero">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">nan_to_zero</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#nan_to_zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.nan_to_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts any nans in a numpy float array to 0</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.np_find_closest">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">np_find_closest</code><span class="sig-paren">(</span><em>a</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#np_find_closest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.np_find_closest" title="Permalink to this definition">¶</a></dt>
<dd><p>From <a class="reference external" href="https://stackoverflow.com/questions/8914491/finding-the-nearest-value-and-return-the-index-of-array-in-python">https://stackoverflow.com/questions/8914491/finding-the-nearest-value-and-return-the-index-of-array-in-python</a>
Find index of closest value to array v in array a.  Returns an array of the same size as v
a must be sorted
&gt;&gt;&gt; assert(all(np_find_closest(np.array([3, 4, 6]), np.array([4, 2])) == np.array([1, 0])))</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.np_get_index">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">np_get_index</code><span class="sig-paren">(</span><em>array</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#np_get_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.np_get_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get index of a value in a numpy array.  Returns -1 if the value does not exist.</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.resample_trade_bars">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">resample_trade_bars</code><span class="sig-paren">(</span><em>df</em>, <em>sampling_frequency</em>, <em>resample_funcs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#resample_trade_bars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.resample_trade_bars" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample trade bars using sampling frequency</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> (<em>pd.DataFrame</em>) – Must contain an index of numpy datetime64 type which is monotonically increasing</li>
<li><strong>sampling_frequency</strong> (<em>str</em>) – See pandas frequency strings</li>
<li><strong>(</strong><strong>dict of str</strong> (<em>resample_funcs</em>) – int) : a dictionary of column name -&gt; resampling function for any columns that are custom defined.  Default None.
If there is no entry for a custom column, defaults to ‘last’ for that column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Resampled dataframe</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;date&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-08 15:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-09 13:30:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-09 15:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-11 15:00:00&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[ns]&#39;</span><span class="p">),</span>
<span class="gp">... </span>         <span class="s1">&#39;o&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.9</span><span class="p">,</span> <span class="mf">9.1</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">]),</span>
<span class="gp">... </span>         <span class="s1">&#39;h&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span> <span class="mf">8.7</span><span class="p">]),</span>
<span class="gp">... </span>         <span class="s1">&#39;l&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.8</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.2</span><span class="p">,</span> <span class="mf">8.4</span><span class="p">]),</span>
<span class="gp">... </span>         <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.95</span><span class="p">,</span> <span class="mf">9.2</span><span class="p">,</span> <span class="mf">9.35</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">]),</span>
<span class="gp">... </span>         <span class="s1">&#39;v&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">]),</span>
<span class="gp">... </span>         <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;vwap&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">l</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">resample_trade_bars</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sampling_frequency</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">resample_funcs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">sampling_frequency</span> <span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">sampling_frequency</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">vwap</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">9.24</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">vwap</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mf">8.4</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.resample_ts">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">resample_ts</code><span class="sig-paren">(</span><em>dates</em>, <em>values</em>, <em>sampling_frequency</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#resample_ts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.resample_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample a pair of dates and values using sampling frequency, using the last value if it does not exist at bin edge.  See pandas.Series.resample</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> – a numpy datetime64 array</li>
<li><strong>values</strong> – a numpy array</li>
<li><strong>sampling_frequency</strong> – See pandas frequency strings</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.resample_vwap">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">resample_vwap</code><span class="sig-paren">(</span><em>df</em>, <em>sampling_frequency</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#resample_vwap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.resample_vwap" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute weighted average of vwap given higher frequency vwap and volume</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.series_to_array">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">series_to_array</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#series_to_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.series_to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a pandas series to a numpy array.  If the object is not a pandas Series return it back unchanged</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.set_defaults">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">set_defaults</code><span class="sig-paren">(</span><em>df_float_sf=8</em>, <em>df_display_max_rows=200</em>, <em>df_display_max_columns=99</em>, <em>np_seterr='raise'</em>, <em>plot_style='ggplot'</em>, <em>mpl_figsize=(8</em>, <em>6)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#set_defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.set_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Set some display defaults to make it easier to view dataframes and graphs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df_float_sf</strong> – Number of significant figures to show in dataframes (default 4). Set to None to use pandas defaults</li>
<li><strong>df_display_max_rows</strong> – Number of rows to display for pandas dataframes when you print them (default 200).  Set to None to use pandas defaults</li>
<li><strong>df_display_max_columns</strong> – Number of columns to display for pandas dataframes when you print them (default 99).  Set to None to use pandas defaults</li>
<li><strong>np_seterr</strong> – Error mode for numpy warnings.  See numpy seterr function for details.  Set to None to use numpy defaults</li>
<li><strong>plot_style</strong> – Style for matplotlib plots.  Set to None to use default plot style.</li>
<li><strong>mpl_figsize</strong> – Default figure size to use when displaying matplotlib plots (default 8,6).  Set to None to use defaults</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.shift_np">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">shift_np</code><span class="sig-paren">(</span><em>array</em>, <em>n</em>, <em>fill_value=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#shift_np"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.shift_np" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to pandas.Series.shift but works on numpy arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> – The numpy array to shift</li>
<li><strong>n</strong> – Number of places to shift, can be positive or negative</li>
<li><strong>fill_value</strong> – After shifting, there will be empty slots left in the array.  If set, fill these with fill_value.
If fill_value is set to None (default), we will fill these with False for boolean arrays, np.nan for floats</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.str2date">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">str2date</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#str2date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.str2date" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a string like “2008-01-15 15:00:00” to a numpy datetime64.  If s is not a string, return s back</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.strtup2date">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">strtup2date</code><span class="sig-paren">(</span><em>tup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#strtup2date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.strtup2date" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a string tuple like (“2008-01-15”, “2009-01-16”) to a numpy datetime64 tuple.
If the tuple does not contain strings, return it back unchanged</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.to_csv">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">to_csv</code><span class="sig-paren">(</span><em>df</em>, <em>file_name</em>, <em>index=False</em>, <em>compress=False</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#to_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a temporary file then renames to the permanent file so we don’t have half written files.
Also optionally compresses using the xz algorithm</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.touch">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">touch</code><span class="sig-paren">(</span><em>fname</em>, <em>mode=438</em>, <em>dir_fd=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#touch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.touch" title="Permalink to this definition">¶</a></dt>
<dd><p>replicate unix touch command, i.e create file if it doesn’t exist, otherwise update timestamp</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pq_utils.zero_to_nan">
<code class="descclassname">pyqstrat.pq_utils.</code><code class="descname">zero_to_nan</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_utils.html#zero_to_nan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_utils.zero_to_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts any zeros in a numpy array to nans</p>
</dd></dl>

</div>
<div class="section" id="module-pyqstrat.pq_types">
<span id="pyqstrat-pq-types-module"></span><h2>pyqstrat.pq_types module<a class="headerlink" href="#module-pyqstrat.pq_types" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.pq_types.Contract">
<em class="property">class </em><code class="descclassname">pyqstrat.pq_types.</code><code class="descname">Contract</code><a class="reference internal" href="_modules/pyqstrat/pq_types.html#Contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.Contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A contract such as a stock, option or a future that can be traded</p>
<dl class="staticmethod">
<dt id="pyqstrat.pq_types.Contract.create">
<em class="property">static </em><code class="descname">create</code><span class="sig-paren">(</span><em>symbol</em>, <em>contract_group</em>, <em>expiry=None</em>, <em>multiplier=1.0</em>, <em>properties=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_types.html#Contract.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.Contract.create" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>symbol</strong> (<em>str</em>) – A unique string reprenting this contract. e.g IBM or ESH9</li>
<li><strong>contract_group</strong> (<a class="reference internal" href="#pyqstrat.pq_types.ContractGroup" title="pyqstrat.pq_types.ContractGroup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code></a>) – We sometimes need to group contracts for calculating PNL, for example, you may have a strategy
which has 3 legs, a long option, a short option and a future or equity used to hedge delta.  In this case, you will be trading
different symbols over time as options and futures expire, but you may want to track PNL for each leg using a contract group for each leg.
So you could create contract groups ‘Long Option’, ‘Short Option’ and ‘Hedge’ and assign contracts to these.</li>
<li><strong>(</strong><strong>obj</strong> (<em>properties</em>) – <cite>np.datetime64</cite> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime.datetime</span></code>, optional): In the case of a future or option, the date and time when the
contract expires.  For equities and other non expiring contracts, set this to None.  Default None.</li>
<li><strong>multiplier</strong> (<em>float</em><em>, </em><em>optional</em>) – If the market price convention is per unit, and the unit is not the same as contract size,
set the multiplier here. For example, for E-mini contracts, each contract is 50 units and the price is per unit,
so multiplier would be 50.  Default 1</li>
<li><strong>(</strong><strong>obj</strong> – <cite>types.SimpleNamespace</cite>, optional): Any data you want to store with this contract.
For example, you may want to store option strike.  Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pq_types.ContractGroup">
<em class="property">class </em><code class="descclassname">pyqstrat.pq_types.</code><code class="descname">ContractGroup</code><a class="reference internal" href="_modules/pyqstrat/pq_types.html#ContractGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.ContractGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A way to group contracts for figuring out which indicators, rules and signals to apply to a contract and for PNL reporting</p>
<dl class="method">
<dt id="pyqstrat.pq_types.ContractGroup.add_contract">
<code class="descname">add_contract</code><span class="sig-paren">(</span><em>contract</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_types.html#ContractGroup.add_contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.ContractGroup.add_contract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="pyqstrat.pq_types.ContractGroup.create">
<em class="property">static </em><code class="descname">create</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_types.html#ContractGroup.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.ContractGroup.create" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – Name of the group</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pq_types.ContractGroup.get_contract">
<code class="descname">get_contract</code><span class="sig-paren">(</span><em>symbol</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_types.html#ContractGroup.get_contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.ContractGroup.get_contract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pq_types.Trade">
<em class="property">class </em><code class="descclassname">pyqstrat.pq_types.</code><code class="descname">Trade</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>price</em>, <em>fee=0.0</em>, <em>commission=0.0</em>, <em>order=None</em>, <em>properties=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_types.html#Trade"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.Trade" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pq_types.Trade.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>price</em>, <em>fee=0.0</em>, <em>commission=0.0</em>, <em>order=None</em>, <em>properties=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/pq_types.html#Trade.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.pq_types.Trade.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract</strong> (<a class="reference internal" href="#pyqstrat.pq_types.Contract" title="pyqstrat.pq_types.Contract"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Contract</span></code></a>) – </li>
<li><strong>timestamp</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>) – Trade execution datetime</li>
<li><strong>qty</strong> (<em>float</em>) – Number of contracts or shares filled</li>
<li><strong>price</strong> (<em>float</em>) – Trade price</li>
<li><strong>fee</strong> (<em>float</em><em>, </em><em>optional</em>) – Fees paid to brokers or others. Default 0</li>
<li><strong>commision</strong> (<em>float</em><em>, </em><em>optional</em>) – Commission paid to brokers or others. Default 0</li>
<li><strong>order</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">pq.Order</span></code>, optional) – A reference to the order that created this trade. Default None</li>
<li><strong>(</strong><strong>obj</strong> (<em>properties</em>) – <cite>types.SimpleNamespace</cite>, optional): Any data you want to store with this contract.
For example, you may want to store bid / ask prices at time of trade.  Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyqstrat.holiday_calendars">
<span id="pyqstrat-holiday-calendars-module"></span><h2>pyqstrat.holiday_calendars module<a class="headerlink" href="#module-pyqstrat.holiday_calendars" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.holiday_calendars.Calendar">
<em class="property">class </em><code class="descclassname">pyqstrat.holiday_calendars.</code><code class="descname">Calendar</code><span class="sig-paren">(</span><em>holidays</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="pyqstrat.holiday_calendars.Calendar.EUREX">
<code class="descname">EUREX</code><em class="property"> = 'eurex'</em><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.EUREX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.holiday_calendars.Calendar.NYSE">
<code class="descname">NYSE</code><em class="property"> = 'nyse'</em><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.NYSE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>holidays</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Do not use this function directly.  Use Calendar.get_calendar instead
:param holidays: holidays for this calendar, excluding weekends
:type holidays: np.array of datetime64[D]</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.add_calendar">
<code class="descname">add_calendar</code><span class="sig-paren">(</span><em>holidays</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.add_calendar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.add_calendar" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a trading calendar to the class level calendars dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>exchange_name</strong> (<em>str</em>) – Name of the exchange.</li>
<li><strong>holidays</strong> (<em>np.array of datetime64</em><em>[</em><em>D</em><em>]</em>) – holidays for this exchange, excluding weekends</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.add_trading_days">
<code class="descname">add_trading_days</code><span class="sig-paren">(</span><em>start</em>, <em>num_days</em>, <em>roll='raise'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.add_trading_days"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.add_trading_days" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds trading days to a start date</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> – np.datetime64 or str or datetime</li>
<li><strong>num_days</strong> (<em>int</em>) – number of trading days to add</li>
<li><strong>roll</strong> (<em>str</em><em>, </em><em>optional</em>) – one of ‘raise’, ‘nat’, ‘forward’, ‘following’, ‘backward’, ‘preceding’, ‘modifiedfollowing’, ‘modifiedpreceding’ or ‘allow’}
‘allow’ is a special case in which case, adding 1 day to a holiday will act as if it was not a holiday, and give you the next business day’
The rest of the values are the same as in the numpy busday_offset function
From numpy documentation:
How to treat dates that do not fall on a valid day. The default is ‘raise’.
‘raise’ means to raise an exception for an invalid day.
‘nat’ means to return a NaT (not-a-time) for an invalid day.
‘forward’ and ‘following’ mean to take the first valid day later in time.
‘backward’ and ‘preceding’ mean to take the first valid day earlier in time.
‘modifiedfollowing’ means to take the first valid day later in time unless it is across a Month boundary,
in which case to take the first valid day earlier in time.
‘modifiedpreceding’ means to take the first valid day earlier in time unless it is across a Month boundary,
in which case to take the first valid day later in time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The date num_days trading days after start</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.datetime64[D]</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calendar</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="n">get_calendar</span><span class="p">(</span><span class="n">Calendar</span><span class="o">.</span><span class="n">NYSE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calendar</span><span class="o">.</span><span class="n">add_trading_days</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">numpy.datetime64(&#39;2015-12-28&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calendar</span><span class="o">.</span><span class="n">add_trading_days</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2017-04-15&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="s1">&#39;preceding&#39;</span><span class="p">)</span> <span class="c1"># 4/14/2017 is a Friday and a holiday</span>
<span class="go">numpy.datetime64(&#39;2017-04-13&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calendar</span><span class="o">.</span><span class="n">add_trading_days</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2017-04-08&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="s1">&#39;preceding&#39;</span><span class="p">)</span> <span class="c1"># 4/7/2017 is a Friday and not a holiday</span>
<span class="go">numpy.datetime64(&#39;2017-04-07&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calendar</span><span class="o">.</span><span class="n">add_trading_days</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-02-17 15:25&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="s1">&#39;allow&#39;</span><span class="p">)</span>
<span class="go">numpy.datetime64(&#39;2019-02-19T15:25&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calendar</span><span class="o">.</span><span class="n">add_trading_days</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-02-17 15:25&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="s1">&#39;allow&#39;</span><span class="p">)</span>
<span class="go">numpy.datetime64(&#39;2019-02-15T15:25&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.get_calendar">
<code class="descname">get_calendar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.get_calendar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.get_calendar" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a calendar object for the given exchange:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exchange_name</strong> (<em>str</em>) – The exchange for which you want a calendar.  Calendar.NYSE, Calendar.EUREX are predefined.</li>
<li><strong>you want to add a new calendar</strong><strong>, </strong><strong>use the add_calendar class level function</strong> (<em>If</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The calendar object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyqstrat.holiday_calendars.Calendar" title="pyqstrat.holiday_calendars.Calendar">Calendar</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.get_trading_days">
<code class="descname">get_trading_days</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>include_first=False</em>, <em>include_last=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.get_trading_days"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.get_trading_days" title="Permalink to this definition">¶</a></dt>
<dd><p>Get back a list of numpy dates that are trading days between the start and end</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="n">get_calendar</span><span class="p">(</span><span class="n">Calendar</span><span class="o">.</span><span class="n">NYSE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">get_trading_days</span><span class="p">(</span><span class="s1">&#39;2005-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-01-08&#39;</span><span class="p">)</span>
<span class="go">array([&#39;2005-01-03&#39;, &#39;2005-01-04&#39;, &#39;2005-01-05&#39;, &#39;2005-01-06&#39;, &#39;2005-01-07&#39;], dtype=&#39;datetime64[D]&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">get_trading_days</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">array([&#39;2005-01-03&#39;, &#39;2005-01-04&#39;, &#39;2005-01-05&#39;, &#39;2005-01-06&#39;,</span>
<span class="go">       &#39;2005-01-07&#39;, &#39;2005-01-10&#39;, &#39;2005-01-11&#39;, &#39;2005-01-12&#39;,</span>
<span class="go">       &#39;2005-01-13&#39;, &#39;2005-01-14&#39;, &#39;2005-01-18&#39;, &#39;2005-01-19&#39;,</span>
<span class="go">       &#39;2005-01-20&#39;, &#39;2005-01-21&#39;, &#39;2005-01-24&#39;, &#39;2005-01-25&#39;,</span>
<span class="go">       &#39;2005-01-26&#39;, &#39;2005-01-27&#39;, &#39;2005-01-28&#39;, &#39;2005-01-31&#39;, &#39;2005-02-01&#39;], dtype=&#39;datetime64[D]&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">get_trading_days</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="n">include_last</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">array([&#39;2016-01-06&#39;, &#39;2016-01-07&#39;, &#39;2016-01-08&#39;, &#39;2016-01-11&#39;,</span>
<span class="go">       &#39;2016-01-12&#39;, &#39;2016-01-13&#39;, &#39;2016-01-14&#39;, &#39;2016-01-15&#39;,</span>
<span class="go">       &#39;2016-01-19&#39;, &#39;2016-01-20&#39;, &#39;2016-01-21&#39;, &#39;2016-01-22&#39;,</span>
<span class="go">       &#39;2016-01-25&#39;, &#39;2016-01-26&#39;, &#39;2016-01-27&#39;, &#39;2016-01-28&#39;], dtype=&#39;datetime64[D]&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">get_trading_days</span><span class="p">(</span><span class="s1">&#39;2017-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-07-08&#39;</span><span class="p">,</span> <span class="n">include_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">array([&#39;2017-07-05&#39;, &#39;2017-07-06&#39;, &#39;2017-07-07&#39;], dtype=&#39;datetime64[D]&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">get_trading_days</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2017-07-04&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2017-07-08&#39;</span><span class="p">),</span> <span class="n">include_first</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">array([&#39;2017-07-05&#39;, &#39;2017-07-06&#39;, &#39;2017-07-07&#39;], dtype=&#39;datetime64[D]&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.is_trading_day">
<code class="descname">is_trading_day</code><span class="sig-paren">(</span><em>dates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.is_trading_day"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.is_trading_day" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the date is not a holiday or a weekend</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dates</strong> – str or datetime.datetime or np.datetime64[D] or numpy array of np.datetime64[D]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Whether this date is a trading day</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eurex</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="n">get_calendar</span><span class="p">(</span><span class="n">Calendar</span><span class="o">.</span><span class="n">EUREX</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eurex</span><span class="o">.</span><span class="n">is_trading_day</span><span class="p">(</span><span class="s1">&#39;2016-12-25&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eurex</span><span class="o">.</span><span class="n">is_trading_day</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="n">get_calendar</span><span class="p">(</span><span class="n">Calendar</span><span class="o">.</span><span class="n">NYSE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">is_trading_day</span><span class="p">(</span><span class="s1">&#39;2017-04-01&#39;</span><span class="p">)</span> <span class="c1"># Weekend</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span><span class="o">.</span><span class="n">is_trading_day</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s1">&#39;2017-04-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-04-09&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">))</span> <span class="c1"># doctest:+ELLIPSIS</span>
<span class="go">array([False, False,  True,  True,  True,  True,  True, False]...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.holiday_calendars.Calendar.num_trading_days">
<code class="descname">num_trading_days</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>include_first=False</em>, <em>include_last=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#Calendar.num_trading_days"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.Calendar.num_trading_days" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of trading days between two date series including those two dates
You can pass in a string like ‘2009-01-01’ or a python date or a pandas series for
start and end</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eurex</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="n">get_calendar</span><span class="p">(</span><span class="n">Calendar</span><span class="o">.</span><span class="n">EUREX</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eurex</span><span class="o">.</span><span class="n">num_trading_days</span><span class="p">(</span><span class="s1">&#39;2009-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2011-12-31&#39;</span><span class="p">)</span>
<span class="go">772</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;20130101&#39;</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">increments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">29</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PerformanceWarning</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates2</span> <span class="o">=</span> <span class="n">dates</span> <span class="o">+</span> <span class="n">increments</span> <span class="o">*</span> <span class="n">dates</span><span class="o">.</span><span class="n">freq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="n">dates2</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nyse</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="n">get_calendar</span><span class="p">(</span><span class="n">Calendar</span><span class="o">.</span><span class="n">NYSE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;float&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.1f}</span><span class="s1">&#39;</span><span class="p">})</span>  <span class="c1"># After numpy 1.13 positive floats don&#39;t have a leading space for sign</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nyse</span><span class="o">.</span><span class="n">num_trading_days</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
<span class="go">[3.0 0.0 1.0 5.0 nan 8.0 nan 20.0]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.holiday_calendars.read_holidays">
<code class="descclassname">pyqstrat.holiday_calendars.</code><code class="descname">read_holidays</code><span class="sig-paren">(</span><em>calendar_name</em>, <em>dirname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/holiday_calendars.html#read_holidays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.holiday_calendars.read_holidays" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a csv with a holidays column containing holidays (not including weekends)</p>
</dd></dl>

</div>
<div class="section" id="module-pyqstrat.account">
<span id="pyqstrat-account-module"></span><h2>pyqstrat.account module<a class="headerlink" href="#module-pyqstrat.account" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.account.Account">
<em class="property">class </em><code class="descclassname">pyqstrat.account.</code><code class="descname">Account</code><span class="sig-paren">(</span><em>contract_groups</em>, <em>timestamps</em>, <em>price_function</em>, <em>strategy_context</em>, <em>starting_equity=1000000.0</em>, <em>pnl_calc_time=900</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An Account calculates pnl for a set of contracts</p>
<dl class="method">
<dt id="pyqstrat.account.Account.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>contract_groups</em>, <em>timestamps</em>, <em>price_function</em>, <em>strategy_context</em>, <em>starting_equity=1000000.0</em>, <em>pnl_calc_time=900</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>) – Contract groups that we want to compute PNL for</li>
<li><strong>timestamps</strong> (<em>list of np.datetime64</em>) – Timestamps that we might compute PNL at</li>
<li><strong>price_function</strong> (<em>function</em>) – Function that takes a symbol, timestamps, index, strategy context and
returns the price used to compute pnl</li>
<li><strong>starting_equity</strong> (<em>float</em><em>, </em><em>optional</em>) – Starting equity in account currency.  Default 1.e6</li>
<li><strong>pnl_calc_time</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of minutes past midnight that we should calculate PNL at.  Default 15 * 60, i.e. 3 pm</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.add_trades">
<code class="descname">add_trades</code><span class="sig-paren">(</span><em>trades</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.add_trades"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.add_trades" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.calc">
<code class="descname">calc</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes P&amp;L and stores it internally for all contracts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timestamp</strong> (<em>np.datetime64</em>) – timestamp to compute P&amp;L at.  Account remembers the last timestamp it computed P&amp;L up to and will compute P&amp;L
between these and including timestamp. If there is more than one day between the last index and current index, we will
include pnl for at the defined pnl_calc_time for those dates as well.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.df_account_pnl">
<code class="descname">df_account_pnl</code><span class="sig-paren">(</span><em>contract_group=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.df_account_pnl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.df_account_pnl" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns PNL at the account level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>contract_group</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – If set, we only return pnl for this contract_group</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.df_pnl">
<code class="descname">df_pnl</code><span class="sig-paren">(</span><em>contract_groups=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.df_pnl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.df_pnl" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe with P&amp;L columns broken down by contract group and symbol</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>contract_group</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Return PNL for this contract group.
If None (default), include all contract groups</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.df_trades">
<code class="descname">df_trades</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.df_trades"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.df_trades" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe of trades</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract_group</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Return trades for this contract group.
If None (default), include all contract groups</li>
<li><strong>start_date</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>, optional) – Include trades with date greater than or equal to this timestamp.</li>
<li><strong>end_date</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>, optional) – Include trades with date less than or equal to this timestamp.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.equity">
<code class="descname">equity</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.equity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.equity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns equity in this account in Account currency.  Will cause calculation if Account has not previously
calculated up to this date</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.position">
<code class="descname">position</code><span class="sig-paren">(</span><em>contract_group</em>, <em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns netted position for a contract_group at a given date in number of contracts or shares.</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.positions">
<code class="descname">positions</code><span class="sig-paren">(</span><em>contract_group</em>, <em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all non-zero positions in a contract group</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.symbols">
<code class="descname">symbols</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.symbols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.symbols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.account.Account.trades">
<code class="descname">trades</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#Account.trades"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.Account.trades" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of trades with the given symbol and with trade date between (and including) start date
and end date if they are specified. If symbol is None trades for all symbols are returned</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.account.ContractPNL">
<em class="property">class </em><code class="descclassname">pyqstrat.account.</code><code class="descname">ContractPNL</code><span class="sig-paren">(</span><em>contract</em>, <em>account_timestamps</em>, <em>price_function</em>, <em>strategy_context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#ContractPNL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.ContractPNL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Computes pnl for a single contract over time given trades and market data</p>
<dl class="method">
<dt id="pyqstrat.account.ContractPNL.calc_net_pnl">
<code class="descname">calc_net_pnl</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#ContractPNL.calc_net_pnl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.ContractPNL.calc_net_pnl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.account.ContractPNL.df">
<code class="descname">df</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#ContractPNL.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.ContractPNL.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pandas dataframe with pnl data</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.account.ContractPNL.net_pnl">
<code class="descname">net_pnl</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#ContractPNL.net_pnl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.ContractPNL.net_pnl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.account.ContractPNL.pnl">
<code class="descname">pnl</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#ContractPNL.pnl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.ContractPNL.pnl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.account.ContractPNL.position">
<code class="descname">position</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#ContractPNL.position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.ContractPNL.position" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.account.find_index_before">
<code class="descclassname">pyqstrat.account.</code><code class="descname">find_index_before</code><span class="sig-paren">(</span><em>sorted_dict</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#find_index_before"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.find_index_before" title="Permalink to this definition">¶</a></dt>
<dd><p>Find index of the first key in a sorted dict that is less than or equal to the key passed in.
If the key is less than the first key in the dict, return -1</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.account.find_last_non_nan_index">
<code class="descclassname">pyqstrat.account.</code><code class="descname">find_last_non_nan_index</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#find_last_non_nan_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.find_last_non_nan_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyqstrat.account.leading_nan_to_zero">
<code class="descclassname">pyqstrat.account.</code><code class="descname">leading_nan_to_zero</code><span class="sig-paren">(</span><em>df</em>, <em>columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/account.html#leading_nan_to_zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.account.leading_nan_to_zero" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyqstrat.orders">
<span id="pyqstrat-orders-module"></span><h2>pyqstrat.orders module<a class="headerlink" href="#module-pyqstrat.orders" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.orders.LimitOrder">
<em class="property">class </em><code class="descclassname">pyqstrat.orders.</code><code class="descname">LimitOrder</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>limit_price</em>, <em>reason_code='none'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#LimitOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.LimitOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="pyqstrat.orders.LimitOrder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>limit_price</em>, <em>reason_code='none'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#LimitOrder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.LimitOrder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Contract</span></code>) – </li>
<li><strong>timestamp</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>) – Time the order was placed</li>
<li><strong>qty</strong> (<em>float</em>) – Number of contracts or shares.  Use a negative quantity for sell orders</li>
<li><strong>limit_price</strong> (<em>float</em>) – Limit price (float)</li>
<li><strong>reason_code</strong> (<em>str</em><em>, </em><em>optional</em>) – The reason this order was created.
Prefer a predefined constant from the ReasonCode class if it matches your reason for creating this order.
Default None</li>
<li><strong>properties</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">SimpleNamespace</span></code>, optional) – Any order specific data we want to store.  Default None</li>
<li><strong>status</strong> (<em>str</em><em>, </em><em>optional</em>) – Status of the order, “open”, “filled”, etc. (default “open”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.orders.MarketOrder">
<em class="property">class </em><code class="descclassname">pyqstrat.orders.</code><code class="descname">MarketOrder</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>reason_code='none'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#MarketOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.MarketOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="pyqstrat.orders.MarketOrder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>reason_code='none'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#MarketOrder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.MarketOrder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Contract</span></code>) – </li>
<li><strong>timestamp</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>) – Time the order was placed</li>
<li><strong>qty</strong> (<em>float</em>) – Number of contracts or shares.  Use a negative quantity for sell orders</li>
<li><strong>reason_code</strong> (<em>str</em><em>, </em><em>optional</em>) – The reason this order was created.
Prefer a predefined constant from the ReasonCode class if it matches your reason for creating this order.
Default None</li>
<li><strong>properties</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">SimpleNamespace</span></code>, optional) – Any order specific data we want to store.  Default None</li>
<li><strong>status</strong> (<em>str</em><em>, </em><em>optional</em>) – Status of the order, “open”, “filled”, etc. (default “open”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.orders.RollOrder">
<em class="property">class </em><code class="descclassname">pyqstrat.orders.</code><code class="descname">RollOrder</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>close_qty</em>, <em>reopen_qty</em>, <em>reason_code='roll future'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#RollOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.RollOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A roll order is used to roll a future from one series to the next.  It represents a sell of one future and the buying of another future.</p>
<dl class="method">
<dt id="pyqstrat.orders.RollOrder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>close_qty</em>, <em>reopen_qty</em>, <em>reason_code='roll future'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#RollOrder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.RollOrder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Contract</span></code>) – </li>
<li><strong>timestamp</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>) – Time the order was placed</li>
<li><strong>close_qty</strong> (<em>float</em>) – Quantity of the future you are rolling</li>
<li><strong>reopen_qty</strong> (<em>float</em>) – Quantity of the future you are rolling to</li>
<li><strong>reason_code</strong> (<em>str</em><em>, </em><em>optional</em>) – The reason this order was created.
Prefer a predefined constant from the ReasonCode class if it matches your reason for creating this order.
Default None</li>
<li><strong>properties</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">SimpleNamespace</span></code>, optional) – Any order specific data we want to store.  Default None</li>
<li><strong>status</strong> (<em>str</em><em>, </em><em>optional</em>) – Status of the order, “open”, “filled”, etc. (default “open”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.orders.StopLimitOrder">
<em class="property">class </em><code class="descclassname">pyqstrat.orders.</code><code class="descname">StopLimitOrder</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>trigger_price</em>, <em>limit_price=nan</em>, <em>reason_code='none'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#StopLimitOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.StopLimitOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Used for stop loss or stop limit orders.  The order is triggered when price goes above or below trigger price, depending on whether this is a short
or long order.  Becomes either a market or limit order at that point, depending on whether you set the limit price or not.</p>
<dl class="method">
<dt id="pyqstrat.orders.StopLimitOrder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>contract</em>, <em>timestamp</em>, <em>qty</em>, <em>trigger_price</em>, <em>limit_price=nan</em>, <em>reason_code='none'</em>, <em>properties=None</em>, <em>status='open'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/orders.html#StopLimitOrder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.orders.StopLimitOrder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Contract</span></code>) – </li>
<li><strong>timestamp</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.datetime64</span></code>) – Time the order was placed</li>
<li><strong>qty</strong> (<em>float</em>) – Number of contracts or shares.  Use a negative quantity for sell orders</li>
<li><strong>trigger_price</strong> (<em>float</em>) – Order becomes a market or limit order if price crosses trigger_price.</li>
<li><strong>limit_price</strong> (<em>float</em><em>, </em><em>optional</em>) – If not set (default), order becomes a market order when price crosses trigger price.
Otherwise it becomes a limit order.  Default np.nan</li>
<li><strong>reason_code</strong> (<em>str</em><em>, </em><em>optional</em>) – The reason this order was created.
Prefer a predefined constant from the ReasonCode class if it matches your reason for creating this order.
Default None</li>
<li><strong>properties</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">SimpleNamespace</span></code>, optional) – Any order specific data we want to store.  Default None</li>
<li><strong>status</strong> (<em>str</em><em>, </em><em>optional</em>) – Status of the order, “open”, “filled”, etc. (default “open”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyqstrat.strategy">
<span id="pyqstrat-strategy-module"></span><h2>pyqstrat.strategy module<a class="headerlink" href="#module-pyqstrat.strategy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.strategy.Strategy">
<em class="property">class </em><code class="descclassname">pyqstrat.strategy.</code><code class="descname">Strategy</code><span class="sig-paren">(</span><em>timestamps</em>, <em>contract_groups</em>, <em>price_function</em>, <em>starting_equity=1000000.0</em>, <em>pnl_calc_time=901</em>, <em>strategy_context=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="pyqstrat.strategy.Strategy.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>timestamps</em>, <em>contract_groups</em>, <em>price_function</em>, <em>starting_equity=1000000.0</em>, <em>pnl_calc_time=901</em>, <em>strategy_context=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>timestamps</strong> (<em>np.array of np.datetime64</em>) – The “heartbeat” of the strategy.  We will evaluate trading rules and
simulate the market at these times.</li>
<li><strong>price_function</strong> – A function that returns the price of a contract at a given timestamp</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>) – The contract groups we will potentially trade.</li>
<li><strong>starting_equity</strong> (<em>float</em><em>, </em><em>optional</em>) – Starting equity in Strategy currency.  Default 1.e6</li>
<li><strong>pnl_calc_time</strong> (<em>int</em><em>, </em><em>optional</em>) – Time of day used to calculate PNL.  Default 15 * 60 (3 pm)</li>
<li><strong>strategy_context</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">types.SimpleNamespace</span></code>, optional) – A storage class where you can store key / value pairs
relevant to this strategy.  For example, you may have a pre-computed table of correlations that you use in the
indicator or trade rule functions.
If not set, the __init__ function will create an empty member strategy_context object that you can access.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.add_indicator">
<code class="descname">add_indicator</code><span class="sig-paren">(</span><em>name</em>, <em>indicator</em>, <em>contract_groups=None</em>, <em>depends_on=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.add_indicator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.add_indicator" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – Name of the indicator</li>
<li><strong>indicator</strong> – A function that takes strategy timestamps and other indicators and returns a numpy array
containing indicator values.  The return array must have the same length as the timestamps object.
Can also be a numpy array or a pandas Series in which case we just store the values.</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract groups that this indicator applies to.
If not set, it applies to all contract groups.  Default None.</li>
<li><strong>depends_on</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Names of other indicators that we need to compute this indicator.
Default None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.add_market_sim">
<code class="descname">add_market_sim</code><span class="sig-paren">(</span><em>market_sim_function</em>, <em>contract_groups=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.add_market_sim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.add_market_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a market simulator.  A market simulator takes a list of Orders as input and returns a list of Trade objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>market_sim_function</strong> (<em>function</em>) – A function that takes a list of Orders and Indicators as input
and returns a list of Trade objects</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract groups that this simulator applies to.
If not set, it applies to all contract groups.  Default None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.add_rule">
<code class="descname">add_rule</code><span class="sig-paren">(</span><em>name</em>, <em>rule_function</em>, <em>signal_name</em>, <em>sig_true_values=None</em>, <em>rule_type=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.add_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.add_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a trading rule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) – Name of the trading rule</li>
<li><strong>rule_function</strong> (<em>function</em>) – A trading rule function that returns a list of Orders</li>
<li><strong>signal_name</strong> (<em>str</em>) – The strategy will call the trading rule function when the signal with this name matches sig_true_values</li>
<li><strong>sig_true_values</strong> (<em>numpy array</em><em>, </em><em>optional</em>) – If the signal value at a bar is equal to one of these values,
the Strategy will call the trading rule function.  Default [TRUE]</li>
<li><strong>rule_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Can be “entry”, “exit” or None.  Entry rules are only triggered when
the corresponding contract positions are 0
exit rules are only triggered when the corresponding contract positions are non-zero.
If not set, we don’t look at position before triggering the rule.
Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.add_signal">
<code class="descname">add_signal</code><span class="sig-paren">(</span><em>name</em>, <em>signal_function</em>, <em>contract_groups=None</em>, <em>depends_on_indicators=None</em>, <em>depends_on_signals=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.add_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.add_signal" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) – Name of the signal</li>
<li><strong>signal_function</strong> (<em>function</em>) – A function that takes timestamps and a dictionary of indicator value arrays and
returns a numpy array
containing signal values.  The return array must have the same length as the input timestamps</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract groups that this signal applies to.
If not set, it applies to all contract groups.  Default None.</li>
<li><strong>depends_on_indicators</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Names of indicators that we need to compute this signal. Default None.</li>
<li><strong>depends_on_signals</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Names of other signals that we need to compute this signal. Default None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.df_data">
<code class="descname">df_data</code><span class="sig-paren">(</span><em>contract_groups=None</em>, <em>add_pnl=True</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.df_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.df_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add indicators and signals to end of market data and return as a pandas dataframe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – list of contract groups to include.  All if set to None (default)</li>
<li><strong>add_pnl</strong> – If True (default), include P&amp;L columns in dataframe</li>
<li><strong>start_date</strong> – string or numpy datetime64. Default None</li>
<li><strong>end_date</strong> – string or numpy datetime64: Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.df_orders">
<code class="descname">df_orders</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.df_orders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.df_orders" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe with data from orders with the given contract group and with order date between (and including)
start date and end date
if they are specified. If contract_group is None orders for all contract_groups are returned</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.df_pnl">
<code class="descname">df_pnl</code><span class="sig-paren">(</span><em>contract_group=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.df_pnl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.df_pnl" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe with P&amp;L columns.  If contract group is set to None (default), sums up P&amp;L across all contract groups</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.df_returns">
<code class="descname">df_returns</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>sampling_frequency='D'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.df_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.df_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataframe of returns and equity indexed by date.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract_group</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – The contract group to get returns for.
If set to None (default), we return the sum of PNL for all contract groups</li>
<li><strong>sampling_frequency</strong> – Downsampling frequency.  Default is None.  See pandas frequency strings for possible values</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.df_trades">
<code class="descname">df_trades</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.df_trades"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.df_trades" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe with data from trades with the given contract group and with trade date between (and including)
start date and end date
if they are specified. If contract_group is None trades for all contract_groups are returned</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.evaluate_returns">
<code class="descname">evaluate_returns</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>plot=True</em>, <em>display_summary=True</em>, <em>float_precision=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.evaluate_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.evaluate_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of common return metrics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract_group</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract group to evaluate or None (default) for all contract groups</li>
<li><strong>plot</strong> (<em>bool</em>) – If set to True, display plots of equity, drawdowns and returns.  Default False</li>
<li><strong>float_precision</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of significant figures to show in returns.  Default 4</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.orders">
<code class="descname">orders</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.orders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.orders" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of orders with the given contract group and with order date between (and including) start date and
end date if they are specified.
If contract_group is None orders for all contract_groups are returned</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>contract_groups=None</em>, <em>primary_indicators=None</em>, <em>primary_indicators_dual_axis=None</em>, <em>secondary_indicators=None</em>, <em>secondary_indicators_dual_axis=None</em>, <em>indicator_properties=None</em>, <em>signals=None</em>, <em>signal_properties=None</em>, <em>pnl_columns=None</em>, <em>title=None</em>, <em>figsize=(20</em>, <em>15)</em>, <em>date_range=None</em>, <em>date_format=None</em>, <em>sampling_frequency=None</em>, <em>trade_marker_properties=None</em>, <em>hspace=0.15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot indicators, signals, trades, position, pnl</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract groups to plot or None (default) for all
contract groups.</li>
<li><strong>indicators</strong> (<em>primary</em>) – List of indicators to plot in the main indicator section.
Default None (plot everything)</li>
<li><strong>indicators</strong> – List of indicators to plot in the secondary indicator section.
Default None (don’t plot anything)</li>
<li><strong>(</strong><strong>dict of str</strong> (<em>trade_marker_properties</em>) – dict, optional): If set, we use the line color, line type indicated
for the given indicators</li>
<li><strong>signals</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Signals to plot.  Default None (plot everything).</li>
<li><strong>plot_equity</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we plot the equity curve.  Default is True</li>
<li><strong>title</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Title of plot. Default None</li>
<li><strong>figsize</strong> (<em>tuple of int</em>) – Figure size.  Default (20, 15)</li>
<li><strong>date_range</strong> (<em>tuple of str</em><em> or </em><em>np.datetime64</em><em>, </em><em>optional</em>) – Used to restrict the date range of the graph.
Default None</li>
<li><strong>date_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Date format for tick labels on x axis.  If set to None (default),
will be selected based on date range. See matplotlib date format strings</li>
<li><strong>sampling_frequency</strong> (<em>str</em><em>, </em><em>optional</em>) – Downsampling frequency.  The graph may get too busy if you have too many bars
of data, in which case you may want to downsample before plotting.  See pandas frequency strings for
possible values. Default None.</li>
<li><strong>(</strong><strong>dict of str</strong> – tuple, optional): A dictionary of
order reason code -&gt; marker shape, marker size, marker color for plotting trades with different reason codes.
Default is None in which case the dictionary from the ReasonCode class is used</li>
<li><strong>hspace</strong> (<em>float</em><em>, </em><em>optional</em>) – Height (vertical) space between subplots.  Default is 0.15</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.plot_returns">
<code class="descname">plot_returns</code><span class="sig-paren">(</span><em>contract_group=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.plot_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.plot_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Display plots of equity, drawdowns and returns for the given contract group or for all contract groups if contract_group
is None (default)</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.run_indicators">
<code class="descname">run_indicators</code><span class="sig-paren">(</span><em>indicator_names=None</em>, <em>contract_groups=None</em>, <em>clear_all=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.run_indicators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.run_indicators" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate values of the indicators specified and store them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>indicator_names</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of indicator names.  If None (default) run all indicators</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract group to run this indicator for.
If None (default), we run it for all contract groups.</li>
<li><strong>clear_all</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, clears all indicator values before running.  Default False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.run_rules">
<code class="descname">run_rules</code><span class="sig-paren">(</span><em>rule_names=None</em>, <em>contract_groups=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.run_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.run_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Run trading rules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rule_names</strong> – List of rule names.  If None (default) run all rules</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract groups to run this rule for.
If None (default), we run it for all contract groups.</li>
<li><strong>start_date</strong> – Run rules starting from this date. Default None</li>
<li><strong>end_date</strong> – Don’t run rules after this date.  Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.run_signals">
<code class="descname">run_signals</code><span class="sig-paren">(</span><em>signal_names=None</em>, <em>contract_groups=None</em>, <em>clear_all=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.run_signals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.run_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate values of the signals specified and store them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>signal_names</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of signal names.  If None (default) run all signals</li>
<li><strong>contract_groups</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ContractGroup</span></code>, optional) – Contract groups to run this signal for.
If None (default), we run it for all contract groups.</li>
<li><strong>clear_all</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, clears all signal values before running.  Default False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.strategy.Strategy.trades">
<code class="descname">trades</code><span class="sig-paren">(</span><em>contract_group=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/strategy.html#Strategy.trades"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.strategy.Strategy.trades" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of trades with the given contract group and with trade date between (and including) start date
and end date if they are specified.
If contract_group is None trades for all contract_groups are returned</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyqstrat.portfolio">
<span id="pyqstrat-portfolio-module"></span><h2>pyqstrat.portfolio module<a class="headerlink" href="#module-pyqstrat.portfolio" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.portfolio.Portfolio">
<em class="property">class </em><code class="descclassname">pyqstrat.portfolio.</code><code class="descname">Portfolio</code><span class="sig-paren">(</span><em>name='main'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A portfolio contains one or more strategies that run concurrently so you can test running strategies that are uncorrelated together.</p>
<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name='main'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
name: String used for displaying this portfolio</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.add_strategy">
<code class="descname">add_strategy</code><span class="sig-paren">(</span><em>name</em>, <em>strategy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.add_strategy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.add_strategy" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – Name of the strategy</li>
<li><strong>strategy</strong> – Strategy object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.df_returns">
<code class="descname">df_returns</code><span class="sig-paren">(</span><em>sampling_frequency='D'</em>, <em>strategy_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.df_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.df_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dataframe containing equity and returns with a date index.  Equity and returns are combined from all strategies passed in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sampling_frequency</strong> – Date frequency for rows.  Default ‘D’ for daily so we will have one row per day</li>
<li><strong>strategy_names</strong> – A list of strategy names.  By default this is set to None and we use all strategies.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.evaluate_returns">
<code class="descname">evaluate_returns</code><span class="sig-paren">(</span><em>sampling_frequency='D'</em>, <em>strategy_names=None</em>, <em>plot=True</em>, <em>float_precision=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.evaluate_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.evaluate_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of common return metrics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sampling_frequency</strong> – Date frequency.  Default ‘D’ for daily so we downsample to daily returns before computing metrics</li>
<li><strong>strategy_names</strong> – A list of strategy names.  By default this is set to None and we use all strategies.</li>
<li><strong>plot</strong> – If set to True, display plots of equity, drawdowns and returns.  Default False</li>
<li><strong>float_precision</strong> – Number of significant figures to show in returns.  Default 4</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>sampling_frequency='D'</em>, <em>strategy_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Display plots of equity, drawdowns and returns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sampling_frequency</strong> – Date frequency.  Default ‘D’ for daily so we downsample to daily returns before computing metrics</li>
<li><strong>strategy_names</strong> – A list of strategy names.  By default this is set to None and we use all strategies.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>strategy_names=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run indicators, signals and rules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>strategy_names</strong> – A list of strategy names.  By default this is set to None and we use all strategies.</li>
<li><strong>start_date</strong> – Run rules starting from this date.
Sometimes we have a few strategies in a portfolio that need different lead times before they are ready to trade
so you can set this so they are all ready by this date.  Default None</li>
<li><strong>end_date</strong> – Don’t run rules after this date.  Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.run_indicators">
<code class="descname">run_indicators</code><span class="sig-paren">(</span><em>strategy_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.run_indicators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.run_indicators" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute indicators for the strategies specified</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>strategy_names</strong> – A list of strategy names.  By default this is set to None and we use all strategies.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.run_rules">
<code class="descname">run_rules</code><span class="sig-paren">(</span><em>strategy_names=None</em>, <em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.run_rules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.run_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Run rules for the strategies specified.  Must be called after run_indicators and run_signals.
See run function for argument descriptions</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.portfolio.Portfolio.run_signals">
<code class="descname">run_signals</code><span class="sig-paren">(</span><em>strategy_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/portfolio.html#Portfolio.run_signals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.portfolio.Portfolio.run_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute signals for the strategies specified.  Must be called after run_indicators</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>strategy_names</strong> – A list of strategy names.  By default this is set to None and we use all strategies.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyqstrat.optimize">
<span id="pyqstrat-optimize-module"></span><h2>pyqstrat.optimize module<a class="headerlink" href="#module-pyqstrat.optimize" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.optimize.Experiment">
<em class="property">class </em><code class="descclassname">pyqstrat.optimize.</code><code class="descname">Experiment</code><span class="sig-paren">(</span><em>suggestion</em>, <em>cost</em>, <em>other_costs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An Experiment stores a suggestion and its result</p>
<dl class="attribute">
<dt id="pyqstrat.optimize.Experiment.suggestion">
<code class="descname">suggestion</code><a class="headerlink" href="#pyqstrat.optimize.Experiment.suggestion" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of variable name -&gt; value</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.optimize.Experiment.cost">
<code class="descname">cost</code><a class="headerlink" href="#pyqstrat.optimize.Experiment.cost" title="Permalink to this definition">¶</a></dt>
<dd><p>A float representing output of the function we are testing with this suggestion as input.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.optimize.Experiment.other_costs">
<code class="descname">other_costs</code><a class="headerlink" href="#pyqstrat.optimize.Experiment.other_costs" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of other results we want to store and look at later.</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.optimize.Experiment.valid">
<code class="descname">valid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Experiment.valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Experiment.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if all suggestions and costs are finite, i.e not NaN or +/- Infinity</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.optimize.Optimizer">
<em class="property">class </em><code class="descclassname">pyqstrat.optimize.</code><code class="descname">Optimizer</code><span class="sig-paren">(</span><em>name</em>, <em>generator</em>, <em>cost_func</em>, <em>max_processes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optimizer is used to optimize parameters for a strategy.</p>
<dl class="method">
<dt id="pyqstrat.optimize.Optimizer.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>generator</em>, <em>cost_func</em>, <em>max_processes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – string used to display title in plotting, etc.</li>
<li><strong>generator</strong> – A generator (see Python Generators) that takes no inputs and yields a list of dictionaries with parameter name -&gt; parameter value.</li>
<li><strong>cost_func</strong> – A function that takes a dictionary of parameter name -&gt; parameter value as input and outputs cost for that set of parameters.</li>
<li><strong>max_processes</strong> – If not set, the Optimizer will look at the number of CPU cores on your machine to figure out how many processes to run.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.optimize.Optimizer.df_experiments">
<code class="descname">df_experiments</code><span class="sig-paren">(</span><em>sort_column='cost'</em>, <em>ascending=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer.df_experiments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer.df_experiments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe containing experiment data, sorted by sort_column (default “cost”)</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.optimize.Optimizer.experiment_list">
<code class="descname">experiment_list</code><span class="sig-paren">(</span><em>sort_order='lowest_cost'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer.experiment_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer.experiment_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of experiments we have run</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sort_order</strong> – Can be set to lowest_cost, highest_cost or sequence.
If set to sequence, experiments are returned in the sequence in which they were run</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.optimize.Optimizer.plot_2d">
<code class="descname">plot_2d</code><span class="sig-paren">(</span><em>x</em>, <em>y='all'</em>, <em>plot_type='line'</em>, <em>figsize=(15</em>, <em>8)</em>, <em>marker='X'</em>, <em>marker_size=50</em>, <em>marker_color='r'</em>, <em>xlim=None</em>, <em>hspace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer.plot_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer.plot_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2D plot of the optimization output for plotting 1 parameter and costs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – Name of the parameter to plot on the x axis, corresponding to the same name in the generator.</li>
<li><strong>y</strong> – Can be one of:
“cost”
The name of another cost variable corresponding to the output from the cost function
“all”, which creates a subplot for cost plus all other costs</li>
<li><strong>plot_type</strong> – line or scatter (default line)</li>
<li><strong>figsize</strong> – Figure size</li>
<li><strong>marker</strong> – Adds a marker to each point in x, y to show the actual data used for interpolation.  You can set this to None to turn markers off.</li>
<li><strong>hspace</strong> – Vertical space between subplots</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.optimize.Optimizer.plot_3d">
<code class="descname">plot_3d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z='all'</em>, <em>plot_type='surface'</em>, <em>figsize=(15</em>, <em>15)</em>, <em>interpolation='linear'</em>, <em>cmap='viridis'</em>, <em>marker='X'</em>, <em>marker_size=50</em>, <em>marker_color='r'</em>, <em>xlim=None</em>, <em>ylim=None</em>, <em>hspace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer.plot_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer.plot_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 3D plot of the optimization output for plotting 2 parameters and costs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – Name of the parameter to plot on the x axis, corresponding to the same name in the generator.</li>
<li><strong>y</strong> – Name of the parameter to plot on the y axis, corresponding to the same name in the generator.</li>
<li><strong>z</strong> – Can be one of:
“cost”
The name of another cost variable corresponding to the output from the cost function
“all”, which creates a subplot for cost plus all other costs</li>
<li><strong>plot_type</strong> – surface or contour (default surface)</li>
<li><strong>figsize</strong> – Figure size</li>
<li><strong>interpolation</strong> – Can be ‘linear’, ‘nearest’ or ‘cubic’ for plotting z points between the ones passed in.  See scipy.interpolate.griddata for details</li>
<li><strong>cmap</strong> – Colormap to use (default viridis).  See matplotlib colormap for details</li>
<li><strong>marker</strong> – Adds a marker to each point in x, y, z to show the actual data used for interpolation.  You can set this to None to turn markers off.</li>
<li><strong>hspace</strong> – Vertical space between subplots</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.optimize.Optimizer.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>raise_on_error=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#Optimizer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.Optimizer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the optimizer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>raise_on_error</strong> – If set to True, even if we are running a multiprocess optimization, any Exceptions will bubble up and stop the Optimizer.
This can be useful for debugging to see stack traces for Exceptions.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.optimize.test_optimize">
<code class="descclassname">pyqstrat.optimize.</code><code class="descname">test_optimize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/optimize.html#test_optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.optimize.test_optimize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyqstrat.plot">
<span id="pyqstrat-plot-module"></span><h2>pyqstrat.plot module<a class="headerlink" href="#module-pyqstrat.plot" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.plot.BucketedValues">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">BucketedValues</code><span class="sig-paren">(</span><em>name</em>, <em>bucket_names</em>, <em>bucket_values</em>, <em>proportional_widths=True</em>, <em>show_means=True</em>, <em>show_all=True</em>, <em>show_outliers=False</em>, <em>notched=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#BucketedValues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.BucketedValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data in a subplot where x axis is a categorical we summarize properties of a numpy array.  For example, drawing a boxplot with percentiles.</p>
<dl class="method">
<dt id="pyqstrat.plot.BucketedValues.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>bucket_names</em>, <em>bucket_values</em>, <em>proportional_widths=True</em>, <em>show_means=True</em>, <em>show_all=True</em>, <em>show_outliers=False</em>, <em>notched=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#BucketedValues.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.BucketedValues.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – name used for this data in a plot legend</li>
<li><strong>bucket_names</strong> – list of strings used on x axis labels</li>
<li><strong>bucket_values</strong> – list of numpy arrays that are summarized in this plot</li>
<li><strong>proportional_widths</strong> – if set to True, the width each box in the boxplot will be proportional to the number of items in its corresponding array</li>
<li><strong>show_means</strong> – Whether to display a marker where the mean is for each array</li>
<li><strong>show_outliers</strong> – Whether to show markers for outliers that are outside the whiskers.
Box is at Q1 = 25%, Q3 = 75% quantiles, whiskers are at Q1 - 1.5 * (Q3 - Q1), Q3 + 1.5 * (Q3 - Q1)</li>
<li><strong>notched</strong> – Whether to show notches indicating the confidence interval around the median</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.DateFormatter">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">DateFormatter</code><span class="sig-paren">(</span><em>timestamps</em>, <em>fmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#DateFormatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.DateFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.ticker.Formatter</span></code></p>
<p>Formats timestamps on plot axes.  See matplotlib Formatter</p>
</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.DateLine">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">DateLine</code><span class="sig-paren">(</span><em>date</em>, <em>name=None</em>, <em>line_type='dashed'</em>, <em>color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#DateLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.DateLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Draw a vertical line on a plot with a datetime x-axis</p>
</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.HorizontalLine">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">HorizontalLine</code><span class="sig-paren">(</span><em>y</em>, <em>name=None</em>, <em>line_type='dashed'</em>, <em>color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#HorizontalLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.HorizontalLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Draws a horizontal line on a subplot</p>
</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.Plot">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">Plot</code><span class="sig-paren">(</span><em>subplot_list</em>, <em>title=None</em>, <em>figsize=(15</em>, <em>8)</em>, <em>date_range=None</em>, <em>date_format=None</em>, <em>sampling_frequency=None</em>, <em>show_grid=True</em>, <em>show_date_gaps=True</em>, <em>hspace=0.15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#Plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Top level plot containing a list of subplots to draw</p>
<dl class="method">
<dt id="pyqstrat.plot.Plot.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>subplot_list</em>, <em>title=None</em>, <em>figsize=(15</em>, <em>8)</em>, <em>date_range=None</em>, <em>date_format=None</em>, <em>sampling_frequency=None</em>, <em>show_grid=True</em>, <em>show_date_gaps=True</em>, <em>hspace=0.15</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#Plot.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.Plot.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>subplot_list</strong> – List of Subplot objects to draw</li>
<li><strong>title</strong> – Title for this plot.  Default None</li>
<li><strong>figsize</strong> – Figure size.  Default (15, 8)</li>
<li><strong>date_range</strong> – Tuple of strings or numpy datetime64 limiting timestamps to draw.  e.g. (“2018-01-01 14:00”, “2018-01-05”). Default None</li>
<li><strong>date_format</strong> – Date format to use for x-axis</li>
<li><strong>sampling_frequency</strong> – Set this to downsample subplots that have a datetime x axis.
For example, if you have minute bar data, you might want to subsample to hours if the plot is too crowded.
See pandas time frequency strings for possible values.  Default None</li>
<li><strong>show_grid</strong> – If set to True, show a grid on the subplots.  Default True</li>
<li><strong>show_date_gaps</strong> – If set to True, then when there is a gap between timestamps will draw a dashed vertical line.
For example, you may have minute bars and a gap between end of trading day and beginning of next day.
Even if set to True, this will turn itself off if there are too many gaps to avoid clutter.  Default True</li>
<li><strong>hspace</strong> – Height (vertical) space between subplots.  Default 0.15</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.plot.Plot.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>check_data_size=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#Plot.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.Plot.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the subplots.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>check_data_size</strong> – If set to True, will not plot if there are &gt; 100K points to avoid locking up your computer for a long time.
Default True</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.Subplot">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">Subplot</code><span class="sig-paren">(</span><em>data_list</em>, <em>secondary_y=None</em>, <em>title=None</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>zlabel=None</em>, <em>date_lines=None</em>, <em>horizontal_lines=None</em>, <em>vertical_lines=None</em>, <em>xlim=None</em>, <em>ylim=None</em>, <em>height_ratio=1.0</em>, <em>display_legend=True</em>, <em>legend_loc='best'</em>, <em>log_y=False</em>, <em>y_tick_format=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#Subplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.Subplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A top level plot contains a list of subplots, each of which contain a list of data objects to draw</p>
<dl class="method">
<dt id="pyqstrat.plot.Subplot.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>data_list</em>, <em>secondary_y=None</em>, <em>title=None</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>zlabel=None</em>, <em>date_lines=None</em>, <em>horizontal_lines=None</em>, <em>vertical_lines=None</em>, <em>xlim=None</em>, <em>ylim=None</em>, <em>height_ratio=1.0</em>, <em>display_legend=True</em>, <em>legend_loc='best'</em>, <em>log_y=False</em>, <em>y_tick_format=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#Subplot.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.Subplot.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_list</strong> – A list of objects to draw.  Each element can contain XYData, XYZData, TimeSeries, TradeBarSeries, BucketedValues or TradeSet</li>
<li><strong>secondary_y</strong> (<em>list of str</em><em>, </em><em>optional</em>) – A list of objects to draw on the secondary y axis</li>
<li><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title to show for this subplot. Default None</li>
<li><strong>zlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Only applicable to 3d subplots.  Default None</li>
<li><strong>date_lines</strong> (list of <a class="reference internal" href="#pyqstrat.plot.DateLine" title="pyqstrat.plot.DateLine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DateLine</span></code></a>, optional) – A list of DateLine objects to draw as vertical lines.
Only applicable when x axis is datetime.  Default None</li>
<li><strong>horizontal_lines</strong> (list of <a class="reference internal" href="#pyqstrat.plot.HorizontalLine" title="pyqstrat.plot.HorizontalLine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HorizontalLine</span></code></a>, optional) – A list of HorizontalLine objects to draw on the plot.  Default None</li>
<li><strong>vertical_lines</strong> (list of <a class="reference internal" href="#pyqstrat.plot.VerticalLine" title="pyqstrat.plot.VerticalLine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VerticalLine</span></code></a>, optional) – A list of VerticalLine objects to draw on the plot</li>
<li><strong>xlim</strong> (<em>tuple of datetime</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – x limits for the plot as a tuple of numpy datetime objects when x-axis is datetime,
or tuple of floats. Default None</li>
<li><strong>ylim</strong> (<em>tuple of float</em><em>, </em><em>optional</em>) – y limits for the plot.  Tuple of floats.  Default None</li>
<li><strong>height_ratio</strong> (<em>float</em><em>, </em><em>optional</em>) – If you have more than one subplot on a plot, use height ratio to determine how high each subplot should be.
For example, if you set height_ratio = 0.75 for the first subplot and 0.25 for the second,
the first will be 3 times taller than the second one. Default 1.0</li>
<li><strong>display_legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show a legend on the plot.  Default True</li>
<li><strong>legend_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – Location for the legend. Default ‘best’</li>
<li><strong>log_y</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether the y axis should be logarithmic.  Default False</li>
<li><strong>y_tick_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format string to use for y axis labels.  For example, you can decide to
use fixed notation instead of scientific notation or change number of decimal places shown.  Default None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.plot.Subplot.get_all_timestamps">
<code class="descname">get_all_timestamps</code><span class="sig-paren">(</span><em>date_range</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#Subplot.get_all_timestamps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.Subplot.get_all_timestamps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.TimeSeries">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">TimeSeries</code><span class="sig-paren">(</span><em>name</em>, <em>timestamps</em>, <em>values</em>, <em>plot_type='line'</em>, <em>line_type='solid'</em>, <em>line_width=None</em>, <em>color=None</em>, <em>marker=None</em>, <em>marker_size=50</em>, <em>marker_color='red'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TimeSeries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TimeSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data in a subplot where x is an array of numpy datetimes and y is a numpy array of floats</p>
<dl class="method">
<dt id="pyqstrat.plot.TimeSeries.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>timestamps</em>, <em>values</em>, <em>plot_type='line'</em>, <em>line_type='solid'</em>, <em>line_width=None</em>, <em>color=None</em>, <em>marker=None</em>, <em>marker_size=50</em>, <em>marker_color='red'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TimeSeries.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TimeSeries.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:
name: Name to show in plot legend
timestamps: pandas Series or numpy array of datetime64
values: pandas Series or numpy array of floats
plot_type: ‘line’ or ‘scatter’
marker: If set, show a marker at each value in values.  See matplotlib marker types</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.plot.TimeSeries.reindex">
<code class="descname">reindex</code><span class="sig-paren">(</span><em>timestamps</em>, <em>fill</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TimeSeries.reindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TimeSeries.reindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Reindex this series given a new array of timestamps, forward filling holes if fill is set to True</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.TradeBarSeries">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">TradeBarSeries</code><span class="sig-paren">(</span><em>name</em>, <em>timestamps</em>, <em>o</em>, <em>h</em>, <em>l</em>, <em>c</em>, <em>v=None</em>, <em>vwap=None</em>, <em>colorup='darkgreen'</em>, <em>colordown='#F2583E'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeBarSeries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeBarSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data in a subplot that contains open, high, low, close, volume bars.  volume is optional.</p>
<dl class="method">
<dt id="pyqstrat.plot.TradeBarSeries.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>timestamps</em>, <em>o</em>, <em>h</em>, <em>l</em>, <em>c</em>, <em>v=None</em>, <em>vwap=None</em>, <em>colorup='darkgreen'</em>, <em>colordown='#F2583E'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeBarSeries.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeBarSeries.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – Name to show in a legend</li>
<li><strong>colorup</strong> – Color for bars where close &gt;= open.  Default “darkgreen”</li>
<li><strong>colordown</strong> – Color for bars where open &lt; close.  Default “#F2583E”</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.plot.TradeBarSeries.df">
<code class="descname">df</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeBarSeries.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeBarSeries.df" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.plot.TradeBarSeries.reindex">
<code class="descname">reindex</code><span class="sig-paren">(</span><em>all_timestamps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeBarSeries.reindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeBarSeries.reindex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.TradeSet">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">TradeSet</code><span class="sig-paren">(</span><em>name</em>, <em>trades</em>, <em>marker='P'</em>, <em>marker_color=None</em>, <em>marker_size=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data for subplot that contains a set of trades along with marker properties for these trades</p>
<dl class="method">
<dt id="pyqstrat.plot.TradeSet.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>trades</em>, <em>marker='P'</em>, <em>marker_color=None</em>, <em>marker_size=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeSet.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeSet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – String to display in a subplot legend</li>
<li><strong>trades</strong> – List of Trade objects to plot</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.plot.TradeSet.reindex">
<code class="descname">reindex</code><span class="sig-paren">(</span><em>all_timestamps</em>, <em>fill</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#TradeSet.reindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.TradeSet.reindex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.VerticalLine">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">VerticalLine</code><span class="sig-paren">(</span><em>x</em>, <em>name=None</em>, <em>line_type='dashed'</em>, <em>color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#VerticalLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.VerticalLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Draws a vertical line on a subplot where x axis is not a date-time axis</p>
</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.XYData">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">XYData</code><span class="sig-paren">(</span><em>name</em>, <em>x</em>, <em>y</em>, <em>plot_type='line'</em>, <em>line_type='solid'</em>, <em>line_width=None</em>, <em>color=None</em>, <em>marker=None</em>, <em>marker_size=50</em>, <em>marker_color='red'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#XYData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.XYData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data in a subplot that has x and y values that are both arrays of floats</p>
<dl class="method">
<dt id="pyqstrat.plot.XYData.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>x</em>, <em>y</em>, <em>plot_type='line'</em>, <em>line_type='solid'</em>, <em>line_width=None</em>, <em>color=None</em>, <em>marker=None</em>, <em>marker_size=50</em>, <em>marker_color='red'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#XYData.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.XYData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – pandas series or numpy array of floats</li>
<li><strong>y</strong> – pandas series or numpy arry of floats</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.plot.XYZData">
<em class="property">class </em><code class="descclassname">pyqstrat.plot.</code><code class="descname">XYZData</code><span class="sig-paren">(</span><em>name</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>plot_type='surface'</em>, <em>marker='X'</em>, <em>marker_size=50</em>, <em>marker_color='red'</em>, <em>interpolation='linear'</em>, <em>cmap='viridis'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#XYZData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.XYZData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data in a subplot that has x, y and z values that are all floats</p>
<dl class="method">
<dt id="pyqstrat.plot.XYZData.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>plot_type='surface'</em>, <em>marker='X'</em>, <em>marker_size=50</em>, <em>marker_color='red'</em>, <em>interpolation='linear'</em>, <em>cmap='viridis'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#XYZData.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.XYZData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – pandas series or numpy array of floats</li>
<li><strong>y</strong> – pandas series or numpy array of floats</li>
<li><strong>z</strong> – pandas series or numpy array of floats</li>
<li><strong>plot_type</strong> – surface or contour (default surface)</li>
<li><strong>marker</strong> – Adds a marker to each point in x, y, z to show the actual data used for interpolation.  You can set this to None to turn markers off.</li>
<li><strong>interpolation</strong> – Can be ‘linear’, ‘nearest’ or ‘cubic’ for plotting z points between the ones passed in.  See scipy.interpolate.griddata for details</li>
<li><strong>cmap</strong> – Colormap to use (default viridis).  See matplotlib colormap for details</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_3d_plot">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_3d_plot</code><span class="sig-paren">(</span><em>ax</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>plot_type</em>, <em>marker='X'</em>, <em>marker_size=50</em>, <em>marker_color='red'</em>, <em>interpolation='linear'</em>, <em>cmap='viridis'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_3d_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_3d_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a 3d plot.  See XYZData class for explanation of arguments</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">has_display</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">draw_3d_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s1">&#39;contour&#39;</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_boxplot">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_boxplot</code><span class="sig-paren">(</span><em>ax</em>, <em>names</em>, <em>values</em>, <em>proportional_widths=True</em>, <em>notched=False</em>, <em>show_outliers=True</em>, <em>show_means=True</em>, <em>show_all=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a boxplot.  See BucketedValues class for explanation of arguments</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_candlestick">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_candlestick</code><span class="sig-paren">(</span><em>ax</em>, <em>index</em>, <em>o</em>, <em>h</em>, <em>l</em>, <em>c</em>, <em>v</em>, <em>vwap</em>, <em>colorup='darkgreen'</em>, <em>colordown='#F2583E'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_candlestick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_candlestick" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw candlesticks given parrallel numpy arrays of o, h, l, c, v values.  v is optional.
See TradeBarSeries class __init__ for argument descriptions.</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_date_line">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_date_line</code><span class="sig-paren">(</span><em>ax</em>, <em>plot_timestamps</em>, <em>date</em>, <em>linestyle</em>, <em>color</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_date_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_date_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw vertical line on a subplot with datetime x axis</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_horizontal_line">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_horizontal_line</code><span class="sig-paren">(</span><em>ax</em>, <em>y</em>, <em>linestyle</em>, <em>color</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_horizontal_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_horizontal_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw horizontal line on a subplot</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_poly">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_poly</code><span class="sig-paren">(</span><em>ax</em>, <em>left</em>, <em>bottom</em>, <em>top</em>, <em>right</em>, <em>facecolor</em>, <em>edgecolor</em>, <em>zorder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a set of polygrams given parrallel numpy arrays of left, bottom, top, right points</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.draw_vertical_line">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">draw_vertical_line</code><span class="sig-paren">(</span><em>ax</em>, <em>x</em>, <em>linestyle</em>, <em>color</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#draw_vertical_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.draw_vertical_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw vertical line on a subplot</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.get_date_formatter">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">get_date_formatter</code><span class="sig-paren">(</span><em>plot_timestamps</em>, <em>date_format</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#get_date_formatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.get_date_formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an appropriate DateFormatter for x axis labels.
If date_format is set to None, figures out an appropriate date format based on the range of timestamps passed in</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.test_plot">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">test_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#test_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.test_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyqstrat.plot.trade_sets_by_reason_code">
<code class="descclassname">pyqstrat.plot.</code><code class="descname">trade_sets_by_reason_code</code><span class="sig-paren">(</span><em>trades</em>, <em>marker_props={'backtest end': {'color': 'green'</em>, <em>'size': 50</em>, <em>'symbol': '*'}</em>, <em>'enter long': {'color': 'blue'</em>, <em>'size': 50</em>, <em>'symbol': 'P'}</em>, <em>'enter short': {'color': 'red'</em>, <em>'size': 50</em>, <em>'symbol': 'P'}</em>, <em>'exit long': {'color': 'blue'</em>, <em>'size': 50</em>, <em>'symbol': 'X'}</em>, <em>'exit short': {'color': 'red'</em>, <em>'size': 50</em>, <em>'symbol': 'X'}</em>, <em>'none': {'color': 'green'</em>, <em>'size': 50</em>, <em>'symbol': 'o'}</em>, <em>'roll future': {'color': 'green'</em>, <em>'size': 50</em>, <em>'symbol': '&gt;'}}</em>, <em>remove_missing_properties=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/plot.html#trade_sets_by_reason_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.plot.trade_sets_by_reason_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of TradeSet objects.  Each TradeSet contains trades with a different reason code.  The markers for each TradeSet
are set by looking up marker properties for each reason code using the marker_props argument:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trades</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Trade</span></code>) – We look up reason codes using the reason code on the corresponding orders</li>
<li><strong>(</strong><strong>dict of str</strong> (<em>marker_props</em>) – dict, optional): Dictionary from reason code string -&gt; dictionary of marker properties.
See ReasonCode.MARKER_PROPERTIES for example.  Default ReasonCode.MARKER_PROPERTIES</li>
<li><strong>remove_missing_properties</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we remove any reason codes that dont’ have marker properties set.
Default True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyqstrat.evaluator">
<span id="pyqstrat-evaluator-module"></span><h2>pyqstrat.evaluator module<a class="headerlink" href="#module-pyqstrat.evaluator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.evaluator.Evaluator">
<em class="property">class </em><code class="descclassname">pyqstrat.evaluator.</code><code class="descname">Evaluator</code><span class="sig-paren">(</span><em>initial_metrics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>You add functions to the evaluator that are dependent on the outputs of other functions.
The evaluator will call these functions in the right order
so dependencies are computed first before the functions that need their output.
You can retrieve the output of a metric using the metric member function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">initial_metrics</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evaluator</span><span class="o">.</span><span class="n">add_metric</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">dependencies</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evaluator</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evaluator</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">array([ 9, 10, 11])</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyqstrat.evaluator.Evaluator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>initial_metrics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Inits Evaluator with a dictionary of initial metrics that are used to compute subsequent metrics</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>initial_metrics</strong> – a dictionary of string name -&gt; metric.  metric can be any object including a scalar,
an array or a tuple</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.evaluator.Evaluator.add_metric">
<code class="descname">add_metric</code><span class="sig-paren">(</span><em>name</em>, <em>func</em>, <em>dependencies</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator.add_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator.add_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.evaluator.Evaluator.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>metric_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator.compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute metrics using the internal dependency graph</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>metric_names</strong> – an array of metric names.  If not passed in, evaluator will compute and store all metrics</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.evaluator.Evaluator.compute_metric">
<code class="descname">compute_metric</code><span class="sig-paren">(</span><em>metric_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator.compute_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator.compute_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and store a single metric:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>metric_name</strong> – string representing the metric to compute</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.evaluator.Evaluator.metric">
<code class="descname">metric</code><span class="sig-paren">(</span><em>metric_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator.metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of a single metric given its name</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.evaluator.Evaluator.metrics">
<code class="descname">metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#Evaluator.metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.Evaluator.metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of metric name -&gt; metric value</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_amean">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_amean</code><span class="sig-paren">(</span><em>returns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_amean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_amean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes arithmetic mean of a return array, ignoring NaNs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>returns</strong> – a numpy array of floats representing returns at any frequency</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a float</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_amean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]))</span>
<span class="go">3.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_annual_returns">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_annual_returns</code><span class="sig-paren">(</span><em>timestamps</em>, <em>returns</em>, <em>periods_per_year</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_annual_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_annual_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the output of compute_bucketed_returns and returns geometric mean of returns by year</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A tuple with the first element being an array of years (integer) and the second element
an array of annualized returns for those years</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_bucketed_returns">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_bucketed_returns</code><span class="sig-paren">(</span><em>timestamps</em>, <em>returns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_bucketed_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_bucketed_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Bucket returns by year</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>A tuple with the first element being a list of years and the second a list of</dt>
<dd>numpy arrays containing returns for each corresponding year</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_calmar">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_calmar</code><span class="sig-paren">(</span><em>returns_3yr</em>, <em>periods_per_year</em>, <em>mdd_pct_3yr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_calmar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_calmar" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Calmar ratio, which is the annualized return divided by max drawdown over the last 3 years</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_dates_3yr">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_dates_3yr</code><span class="sig-paren">(</span><em>timestamps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_dates_3yr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_dates_3yr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an array of numpy datetimes, return those that are within 3 years of the last date in the array</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_equity">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_equity</code><span class="sig-paren">(</span><em>timestamps</em>, <em>starting_equity</em>, <em>returns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_equity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_equity" title="Permalink to this definition">¶</a></dt>
<dd><p>Given starting equity, timestamps and returns, create a numpy array of equity at each date</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_gmean">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_gmean</code><span class="sig-paren">(</span><em>timestamps</em>, <em>returns</em>, <em>periods_per_year</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_gmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_gmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes geometric mean of an array of returns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>returns</strong> – a numpy array of returns, can contain nans</li>
<li><strong>periods_per_year</strong> – Used for annualizing returns</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a float</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">compute_gmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-05-01&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">]),</span> <span class="mf">252.</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">0.018362</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_mar">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_mar</code><span class="sig-paren">(</span><em>returns</em>, <em>periods_per_year</em>, <em>mdd_pct</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_mar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_mar" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MAR ratio, which is annualized return divided by biggest drawdown since inception.</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_maxdd_date">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_maxdd_date</code><span class="sig-paren">(</span><em>rolling_dd_dates</em>, <em>rolling_dd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_maxdd_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_maxdd_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute date of max drawdown given numpy array of timestamps, and corresponding rolling dd percentages</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_maxdd_date_3yr">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_maxdd_date_3yr</code><span class="sig-paren">(</span><em>rolling_dd_3yr_timestamps</em>, <em>rolling_dd_3yr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_maxdd_date_3yr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_maxdd_date_3yr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute max drawdown date over the last 3 years</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_maxdd_pct">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_maxdd_pct</code><span class="sig-paren">(</span><em>rolling_dd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_maxdd_pct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_maxdd_pct" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute max drawdown percentage given a numpy array of rolling drawdowns, ignoring NaNs</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_maxdd_pct_3yr">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_maxdd_pct_3yr</code><span class="sig-paren">(</span><em>rolling_dd_3yr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_maxdd_pct_3yr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_maxdd_pct_3yr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute max drawdown percentage over the last 3 years</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_maxdd_start">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_maxdd_start</code><span class="sig-paren">(</span><em>rolling_dd_dates</em>, <em>rolling_dd</em>, <em>mdd_date</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_maxdd_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_maxdd_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute date when max drawdown starts, given numpy array of timestamps corresponding rolling dd
percentages and date that max dd starts</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_maxdd_start_3yr">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_maxdd_start_3yr</code><span class="sig-paren">(</span><em>rolling_dd_3yr_timestamps</em>, <em>rolling_dd_3yr</em>, <em>mdd_date_3yr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_maxdd_start_3yr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_maxdd_start_3yr" title="Permalink to this definition">¶</a></dt>
<dd><p>Comput max drawdown start date over the last 3 years</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_num_periods">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_num_periods</code><span class="sig-paren">(</span><em>timestamps</em>, <em>periods_per_year</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_num_periods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_num_periods" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Given an array of timestamps, we compute how many periods there are between the first and last element, where the length</dt>
<dd>of a period is defined by periods_per_year.  For example, if there are 6 periods per year, then each period would be approx. 2 months long.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>timestamps</strong> (<em>np.ndarray of np.datetime64</em>) – a numpy array of returns, can contain nans</li>
<li><strong>periods_per_year</strong> (<em>int</em>) – number of periods between first and last return</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a float</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_num_periods</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-05-01&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_periods_per_year">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_periods_per_year</code><span class="sig-paren">(</span><em>timestamps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_periods_per_year"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_periods_per_year" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Computes trading periods per year for an array of numpy datetime64’s.</dt>
<dd>E.g. if most of the timestamps are separated by 1 day, will return 252.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timestamps</strong> – a numpy array of datetime64’s</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a float</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_periods_per_year</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-09&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">))</span>
<span class="go">252.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">compute_periods_per_year</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-01 10:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-01 10:05&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-01 10:10&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[m]&#39;</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">72576.05</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_return_metrics">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_return_metrics</code><span class="sig-paren">(</span><em>timestamps</em>, <em>rets</em>, <em>starting_equity</em>, <em>leading_non_finite_to_zeros=False</em>, <em>subsequent_non_finite_to_zeros=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_return_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_return_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a set of common metrics using returns (for example, of an instrument or a portfolio)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>timestamps</strong> (<em>np.array of datetime64</em>) – Timestamps for the returns</li>
<li><strong>rets</strong> (<em>nd.array of float</em>) – The returns, use 0.01 for 1%</li>
<li><strong>starting_equity</strong> (<em>float</em>) – Starting equity value in your portfolio</li>
<li><strong>leading_non_finite_to_zeros</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we replace leading nan, inf, -inf returns with zeros.
For example, you may need a warmup period for moving averages.  Default False</li>
<li><strong>subsequent_non_finite_to_zeros</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we replace any nans that follow the first non nan value with zeros.
There may be periods where you have no prices but removing these returns would result in incorrect annualization.
Default True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An Evaluator object containing computed metrics off the returns passed in.
If needed, you can add your own metrics to this object based on the values of existing metrics and recompute the Evaluator.
Otherwise, you can just use the output of the evaluator using the metrics function.</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-05-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-09-01&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">starting_equity</span> <span class="o">=</span> <span class="mf">1.e6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ev</span> <span class="o">=</span> <span class="n">compute_return_metrics</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">rets</span><span class="p">,</span> <span class="n">starting_equity</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">metrics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;gmean&#39;</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.021061</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;sharpe&#39;</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.599382</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;returns_3yr&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015</span><span class="p">])))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_returns_3yr">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_returns_3yr</code><span class="sig-paren">(</span><em>timestamps</em>, <em>returns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_returns_3yr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_returns_3yr" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an array of numpy datetimes and an array of returns, return those that are within 3 years
of the last date in the datetime array</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_rolling_dd">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_rolling_dd</code><span class="sig-paren">(</span><em>timestamps</em>, <em>equity</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_rolling_dd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_rolling_dd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute numpy array of rolling drawdown percentage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>timestamps</strong> – numpy array of datetime64</li>
<li><strong>equity</strong> – numpy array of equity</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_rolling_dd_3yr">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_rolling_dd_3yr</code><span class="sig-paren">(</span><em>timestamps</em>, <em>equity</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_rolling_dd_3yr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_rolling_dd_3yr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute rolling drawdowns over the last 3 years</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_sharpe">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_sharpe</code><span class="sig-paren">(</span><em>returns</em>, <em>amean</em>, <em>periods_per_year</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_sharpe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_sharpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Note that this does not take into risk free returns so it’s really a sharpe0, i.e. assumes risk free returns are 0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>returns</strong> – a numpy array of returns</li>
<li><strong>amean</strong> – arithmetic mean of returns</li>
<li><strong>periods_per_year</strong> – number of trading periods per year</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">compute_sharpe</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">]),</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">252</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">12.727922</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_sortino">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_sortino</code><span class="sig-paren">(</span><em>returns</em>, <em>amean</em>, <em>periods_per_year</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_sortino"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_sortino" title="Permalink to this definition">¶</a></dt>
<dd><p>Note that this assumes target return is 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>returns</strong> – a numpy array of returns</li>
<li><strong>amean</strong> – arithmetic mean of returns</li>
<li><strong>periods_per_year</strong> – number of trading periods per year</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">compute_sortino</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">]),</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">252</span><span class="p">),</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">33.674916</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.compute_std">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">compute_std</code><span class="sig-paren">(</span><em>returns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#compute_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.compute_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes standard deviation of an array of returns, ignoring nans</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.display_return_metrics">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">display_return_metrics</code><span class="sig-paren">(</span><em>metrics</em>, <em>float_precision=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#display_return_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.display_return_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dataframe making it convenient to view the output of the metrics obtained using the compute_return_metrics function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>float_precision</strong> – Change if you want to display floats with more or less significant figures than the default,
3 significant figures.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A one row dataframe with formatted metrics.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.handle_non_finite_returns">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">handle_non_finite_returns</code><span class="sig-paren">(</span><em>timestamps</em>, <em>rets</em>, <em>leading_non_finite_to_zeros</em>, <em>subsequent_non_finite_to_zeros</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#handle_non_finite_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.handle_non_finite_returns" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{: .6g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-01-07&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle_non_finite_returns</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">rets</span><span class="p">,</span> <span class="n">leading_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">subsequent_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(array([&#39;2019-01-03&#39;, &#39;2019-01-04&#39;, &#39;2019-01-05&#39;, &#39;2019-01-06&#39;], dtype=&#39;datetime64[D]&#39;), array([ 3,  4,  0,  5]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle_non_finite_returns</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">rets</span><span class="p">,</span> <span class="n">leading_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">subsequent_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">(array([&#39;2019-01-01&#39;, &#39;2019-01-02&#39;, &#39;2019-01-03&#39;, &#39;2019-01-04&#39;, &#39;2019-01-06&#39;], dtype=&#39;datetime64[D]&#39;), array([ 0,  0,  3,  4,  5]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle_non_finite_returns</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">rets</span><span class="p">,</span> <span class="n">leading_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">subsequent_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">(array([&#39;2019-01-01&#39;, &#39;2019-01-02&#39;, &#39;2019-01-03&#39;, &#39;2019-01-04&#39;, &#39;2019-01-06&#39;], dtype=&#39;datetime64[D]&#39;), array([ 0,  0,  3,  4,  5]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span>  <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handle_non_finite_returns</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">rets</span><span class="p">,</span> <span class="n">leading_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">subsequent_non_finite_to_zeros</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(array([&#39;2019-01-01&#39;, &#39;2019-01-02&#39;, &#39;2019-01-03&#39;, &#39;2019-01-04&#39;, &#39;2019-01-05&#39;, &#39;2019-01-06&#39;],</span>
<span class="go">    dtype=&#39;datetime64[D]&#39;), array([ 1,  2,  3,  4,  4.5,  5]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.plot_return_metrics">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">plot_return_metrics</code><span class="sig-paren">(</span><em>metrics</em>, <em>title=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#plot_return_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.plot_return_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot equity, rolling drawdowns and and a boxplot of annual returns given the output of compute_return_metrics.</p>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.evaluator.test_evaluator">
<code class="descclassname">pyqstrat.evaluator.</code><code class="descname">test_evaluator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/evaluator.html#test_evaluator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.evaluator.test_evaluator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyqstrat.pyqstrat_cpp">
<span id="pyqstrat-pyqstrat-cpp-module"></span><h2>pyqstrat.pyqstrat_cpp module<a class="headerlink" href="#module-pyqstrat.pyqstrat_cpp" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.Aggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">Aggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.Aggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Aggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.Aggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Aggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.AllOpenInterestAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">AllOpenInterestAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllOpenInterestAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<p>Writes out all open interest records</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllOpenInterestAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllOpenInterestAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an open interest record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>oi</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord" title="pyqstrat.pyqstrat_cpp.OpenInterestRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OpenInterestRecord</span></code></a>) – </li>
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllOpenInterestAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllOpenInterestAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
<li><strong>timestamp_unit</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="pyqstrat.pyqstrat_cpp.Schema.Type"><em>Schema.Type</em></a><em>, </em><em>optional</em>) – Whether timestamps are measured as milliseconds or microseconds since the unix epoch.
Defaults to Schema.TIMESTAMP_MILLI</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.AllOtherAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">AllOtherAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllOtherAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<p>Writes out any records that are not trades, quotes or open interest</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllOtherAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllOtherAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>other</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.OtherRecord" title="pyqstrat.pyqstrat_cpp.OtherRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OtherRecord</span></code></a>) – </li>
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllOtherAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllOtherAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
<li><strong>timestamp_unit</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="pyqstrat.pyqstrat_cpp.Schema.Type"><em>Schema.Type</em></a><em>, </em><em>optional</em>) – Whether timestamps are measured as milliseconds or microseconds since the unix epoch.
Defaults to Schema.TIMESTAMP_MILLI</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.AllQuoteAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">AllQuoteAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllQuoteAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<p>Writes out every quote we see</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllQuoteAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllQuoteAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a quote record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>quote</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.QuoteRecord" title="pyqstrat.pyqstrat_cpp.QuoteRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuoteRecord</span></code></a>) – </li>
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllQuoteAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllQuoteAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>batch_size</strong> – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.AllQuotePairAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">AllQuotePairAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllQuotePairAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<p>Writes out every quote pair we find</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllQuotePairAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllQuotePairAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a quote pair record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>quote_pair</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.QuoteRecord" title="pyqstrat.pyqstrat_cpp.QuoteRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuoteRecord</span></code></a>) – line_number (int): The line number of the source file that this trade came from.  Used for debugging</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllQuotePairAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllQuotePairAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
<li><strong>timestamp_unit</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="pyqstrat.pyqstrat_cpp.Schema.Type"><em>Schema.Type</em></a><em>, </em><em>optional</em>) – Whether timestamps are measured as milliseconds or microseconds since the unix epoch.</li>
<li><strong>to Schema.TIMESTAMP_MILLI</strong> (<em>Defaults</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.AllTradeAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">AllTradeAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllTradeAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<p>Writes out every trade we see</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllTradeAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllTradeAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a trade record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trade</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.TradeRecord" title="pyqstrat.pyqstrat_cpp.TradeRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TradeRecord</span></code></a>) – </li>
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.AllTradeAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.AllTradeAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
<li><strong>timestamp_unit</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="pyqstrat.pyqstrat_cpp.Schema.Type"><em>Schema.Type</em></a><em>, </em><em>optional</em>) – Whether timestamps are measured as milliseconds or microseconds since the unix epoch.
Defaults to Schema.TIMESTAMP_MILLI</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriter">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">ArrowWriter</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Writer</span></code></a></p>
<p>A subclass of <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> that batches of records to a disk file in the Apache arrow format.  See Apache arrow for details</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>schema</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema" title="pyqstrat.pyqstrat_cpp.Schema"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Schema</span></code></a>) – A schema object containing the names and datatypes of each field we want to save in a record</li>
<li><strong>create_batch_id_file</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to create a corresponding file that contains a map from batch id -&gt; batch number
so we can easily lookup a batch number and then retrieve it from disk.  Defaults to False</li>
<li><strong>max_batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, when we get this many records, we write out a batch of records to disk.  May be necessary
when we are creating large output files, to avoid running out of memory when reading and writing.  Defaults to -1</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriter.add_record">
<code class="descname">add_record</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriter.add_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a record that will be written to disk at some point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
<li><strong>tuple</strong> (<em>tuple</em>) – Must correspond to the schema defined in the constructor.  For example, if the schema has a bool and a float,
the tuple could be (False, 0.5)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriter.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriter.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the writer and flush any remaining data to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>success</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to False, we had some kind of exception and are cleaning up.  Tells the function to
not indicate the file was written successfully, for example by renaming a temp file to the actual filename.  Defaults to True</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriter.write_batch">
<code class="descname">write_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriter.write_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a batch of records to disk.  The batch can have an optional string id so we can
later retrieve just this batch of records without reading the whole file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_id</strong> (<em>str</em><em>, </em><em>optional</em>) – An identifier which can later be used to retrieve this batch from disk. Defaults to “”</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriterCreator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">ArrowWriterCreator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriterCreator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.WriterCreator" title="pyqstrat.pyqstrat_cpp.WriterCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.WriterCreator</span></code></a></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriterCreator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriterCreator.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ArrowWriterCreator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ArrowWriterCreator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.BadLineHandler">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">BadLineHandler</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.BadLineHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.BadLineHandler.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.BadLineHandler.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.BadLineHandler.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.BadLineHandler.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.CheckFields">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">CheckFields</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.CheckFields" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.CheckFields.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.CheckFields.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.CheckFields.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.CheckFields.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.FileProcessor">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">FileProcessor</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FileProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.FileProcessor.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FileProcessor.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.FileProcessor.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FileProcessor.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.FixedWidthTimeParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">FixedWidthTimeParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FixedWidthTimeParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.TimestampParser" title="pyqstrat.pyqstrat_cpp.TimestampParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.TimestampParser</span></code></a></p>
<p>A helper class that takes a string formatted as HH:MM:SS.xxx and parses it into number of milliseconds or micros since the beginning of the day</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.FixedWidthTimeParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FixedWidthTimeParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>str</em>) – A string like “2018-01-01 08:35:22.132”</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Milliseconds or microseconds since Unix epoch</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.FixedWidthTimeParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FixedWidthTimeParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>micros</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return timestamp in millisecs or microsecs since 1970.  Default false</li>
<li><strong>hours_start</strong> (<em>int</em><em>, </em><em>optional</em>) – index where the hour starts in the timestamp string.  Default -1</li>
<li><strong>hours_size</strong> (<em>int</em><em>, </em><em>optional</em>) – number of characters used for the hour</li>
<li><strong>minutes_start</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>minutes_size</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>seconds_start</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>seconds_size</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>millis_start</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>millis_size</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>micros_start</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
<li><strong>micros_size</strong> (<em>int</em><em>, </em><em>optional</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.FormatTimestampParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">FormatTimestampParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FormatTimestampParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.TimestampParser" title="pyqstrat.pyqstrat_cpp.TimestampParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.TimestampParser</span></code></a></p>
<dl class="docutils">
<dt>Helper class that parses timestamps according to the strftime format string passed in.  strftime is slow so</dt>
<dd>use <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedWithTimeParser</span></code> if your timestamp has a fixed format such as “HH:MM:SS….”</dd>
</dl>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.FormatTimestampParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FormatTimestampParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>str</em>) – The timestamp to parse</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Number of millis or micros since epoch</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.FormatTimestampParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.FormatTimestampParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>base_date</strong> (<em>int</em>) – Sometimes the timestamps in a file contain time only and the name of a file contains the date.  In these cases, pass in the date
as number of millis or micros from the epoch to the start of that date.  If the timestamp has date also, pass in 0 here.</li>
<li><strong>time_format</strong> (<em>str</em><em>, </em><em>optional</em>) – strftime format string for parsing the timestamp.  Defaults to “%H:%M:%S”</li>
<li><strong>micros</strong> (<em>bool</em><em>, </em><em>optional</em>) – If this is set, we will parse and store microseconds.  Otherwise we will parse and store milliseconds.
Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.IsFieldInList">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">IsFieldInList</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.IsFieldInList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.CheckFields" title="pyqstrat.pyqstrat_cpp.CheckFields"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.CheckFields</span></code></a></p>
<p>Simple utility class to check whether the value of fields[flag_idx] is in any of flag_values</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.IsFieldInList.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.IsFieldInList.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flag_values</strong> – a vector of strings containing possible values for the field</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a boolean</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.IsFieldInList.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.IsFieldInList.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fields</strong> – a vector of strings</li>
<li><strong>flag_idx</strong> – the index of fields to check</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.LineFilter">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">LineFilter</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.LineFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.LineFilter.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.LineFilter.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.LineFilter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.LineFilter.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.MissingDataHandler">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">MissingDataHandler</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.MissingDataHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.MissingDataHandler.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.MissingDataHandler.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.MissingDataHandler.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.MissingDataHandler.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.OpenInterestRecord">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">OpenInterestRecord</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Record</span></code></a></p>
<p>Open interest for a future or option.  Usually one record per instrument at the beginning of the day</p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OpenInterestRecord.id">
<code class="descname">id</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a symbol or instrument id, for example, for an option you may concantenate underlying symbol, expiration, strike,
put or call to uniquely identify the instrument</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OpenInterestRecord.timestamp">
<code class="descname">timestamp</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade time, in milliseconds or microseconds since 1/1/1970</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OpenInterestRecord.qty">
<code class="descname">qty</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord.qty" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade quantity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OpenInterestRecord.metadata">
<code class="descname">metadata</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representing any extra information you want to save, such as exchange, or special trade conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.OpenInterestRecord.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">id</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">metadata</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">qty</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">timestamp</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.OtherRecord">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">OtherRecord</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OtherRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Record</span></code></a></p>
<p>Any other data you want to store from market data besides trades, quotes and open interest.  You can capture any
important fields in the metadata attribute</p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OtherRecord.id">
<code class="descname">id</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OtherRecord.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a symbol or instrument id, for example, for an option you may concantenate underlying symbol, expiration, strike,
put or call to uniquely identify the instrument</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OtherRecord.timestamp">
<code class="descname">timestamp</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OtherRecord.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>trade time, in milliseconds or microseconds since 1/1/1970</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.OtherRecord.metadata">
<code class="descname">metadata</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OtherRecord.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>a string representing any extra information you want to save, such as exchange, or special trade conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.OtherRecord.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.OtherRecord.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">id</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">metadata</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">timestamp</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">PriceQtyMissingDataHandler</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.MissingDataHandler" title="pyqstrat.pyqstrat_cpp.MissingDataHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.MissingDataHandler</span></code></a></p>
<p>A helper class that takes a Record as an input, checks whether its a trade or a quote or any open interest record, and if any of
the prices or quantities are 0, sets them to NAN</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>record</strong> – Any subclass of <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Record</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.PrintBadLineHandler">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">PrintBadLineHandler</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.PrintBadLineHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.BadLineHandler" title="pyqstrat.pyqstrat_cpp.BadLineHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.BadLineHandler</span></code></a></p>
<p>A helper class that takes in lines we cannot parse and either prints them and continues or raises an Exception</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.PrintBadLineHandler.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.PrintBadLineHandler.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>line_number</strong> (<em>int</em>) – Line number of the input file that corresponds to this line (for debugging)</li>
<li><strong>line</strong> (<em>str</em>) – The actual line that failed to parse</li>
<li><strong>exception</strong> (<em>Exception</em>) – The exception that caused us to fail to parse this line.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.PrintBadLineHandler.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.PrintBadLineHandler.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>raise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to raise an exception every time this is called or just print debugging info.  Defaults to False</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">QuoteRecord</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Record</span></code></a></p>
<p>A parsed quote record that we can save to disk</p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.id">
<code class="descname">id</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a symbol or instrument id, for example, for an option you may concantenate underlying symbol, expiration, strike,
put or call to uniquely identify the instrument</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.timestamp">
<code class="descname">timestamp</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade time, in milliseconds or microseconds since 1/1/1970</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.bid">
<code class="descname">bid</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.bid" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, this is a bid quote, otherwise it is an offer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.qty">
<code class="descname">qty</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.qty" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade quantity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.price">
<code class="descname">price</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.price" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade price</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.metadata">
<code class="descname">metadata</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representing any extra information you want to save, such as exchange, or special trade conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.QuoteRecord.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteRecord.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">bid</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">id</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">metadata</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">price</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">qty</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">timestamp</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.QuoteTOBAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">QuoteTOBAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteTOBAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<p>Aggregate top of book quotes to top of book records.  If you specify a frequency such as “5m”, we will calculate a record
every 5 minutes which has the top of book at the end of that bar.  If no frequency is specified, we will create a top of book
every time a quote comes in.  We assume that the quotes are all top of book quotes and are written in pairs so we have a bid quote
followed by a offer quote with the same timestamp or vice versa</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.QuoteTOBAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteTOBAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a quote record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>quote</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.QuoteRecord" title="pyqstrat.pyqstrat_cpp.QuoteRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuoteRecord</span></code></a>) – </li>
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.QuoteTOBAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteTOBAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>frequency</strong> (<em>str</em><em>, </em><em>optional</em>) – A string like “5m” indicating the bar size is 5 mins.  Units can be s,m,h or d for second, minute, hour or day.
Defaults to “5m”.  If you set this to “”, each tick will be recorded.</li>
<li><strong>batch_by_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we will create one batch for each id.  This will allow us to retrieve all records for a single</li>
<li><strong>by reading a single batch.  Defaults to True.</strong> (<em>instrument</em>) – </li>
<li><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
<li><strong>timestamp_unit</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="pyqstrat.pyqstrat_cpp.Schema.Type"><em>Schema.Type</em></a><em>, </em><em>optional</em>) – Whether timestamps are measured as milliseconds or microseconds since the unix epoch.
Defaults to Schema.TIMESTAMP_MILLI</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.QuoteTOBAggregator.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.QuoteTOBAggregator.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush all unwritten records to the Writer, which writes them to disk when its close function is called</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.Record">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">Record</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Record" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Record.__init__">
<code class="descname">__init__</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Record.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.RecordFieldParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">RecordFieldParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordFieldParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordFieldParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.RecordFilter">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">RecordFilter</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordFilter.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordFilter.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordFilter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordFilter.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.RecordGenerator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">RecordGenerator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordGenerator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordGenerator.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.RecordParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">RecordParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordParser.add_line">
<code class="descname">add_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordParser.add_line" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>str</em>) – The line we need to parse</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RecordParser.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RecordParser.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return: a subclass of <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Record</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.RegExLineFilter">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">RegExLineFilter</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RegExLineFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.LineFilter" title="pyqstrat.pyqstrat_cpp.LineFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.LineFilter</span></code></a></p>
<p>A helper class that filters lines from the input file based on a regular expression.  Note that regular expressions are slow, so
if you just need to match specific strings, use a string matching filter instead.</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RegExLineFilter.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RegExLineFilter.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>str</em>) – The string that the regular expression should match.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Whether the regex matched</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.RegExLineFilter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.RegExLineFilter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pattern</strong> (<em>str</em>) – The regex pattern to match.  This follows C++ std::regex pattern matching rules as opposed to python</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.Schema">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">Schema</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<p>Describes a list of field names and data types for writing records to disk</p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.types">
<code class="descname">types</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.types" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of (str, type) tuples describing a record with the name of each field and its datatype</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.BOOL">
<code class="descname">BOOL</code><em class="property"> = Type.BOOL</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.BOOL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.FLOAT32">
<code class="descname">FLOAT32</code><em class="property"> = Type.FLOAT32</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.FLOAT32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.FLOAT64">
<code class="descname">FLOAT64</code><em class="property"> = Type.FLOAT64</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.FLOAT64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.INT32">
<code class="descname">INT32</code><em class="property"> = Type.INT32</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.INT32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.INT64">
<code class="descname">INT64</code><em class="property"> = Type.INT64</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.INT64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.STRING">
<code class="descname">STRING</code><em class="property"> = Type.STRING</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.STRING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.TIMESTAMP_MICRO">
<code class="descname">TIMESTAMP_MICRO</code><em class="property"> = Type.TIMESTAMP_MICRO</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.TIMESTAMP_MICRO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.TIMESTAMP_MILLI">
<code class="descname">TIMESTAMP_MILLI</code><em class="property"> = Type.TIMESTAMP_MILLI</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.TIMESTAMP_MILLI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type">
<em class="property">class </em><code class="descname">Type</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.BOOL">
<code class="descname">BOOL</code><em class="property"> = Type.BOOL</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.BOOL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.FLOAT32">
<code class="descname">FLOAT32</code><em class="property"> = Type.FLOAT32</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.FLOAT32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.FLOAT64">
<code class="descname">FLOAT64</code><em class="property"> = Type.FLOAT64</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.FLOAT64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.INT32">
<code class="descname">INT32</code><em class="property"> = Type.INT32</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.INT32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.INT64">
<code class="descname">INT64</code><em class="property"> = Type.INT64</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.INT64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.STRING">
<code class="descname">STRING</code><em class="property"> = Type.STRING</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.STRING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.TIMESTAMP_MICRO">
<code class="descname">TIMESTAMP_MICRO</code><em class="property"> = Type.TIMESTAMP_MICRO</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.TIMESTAMP_MICRO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.TIMESTAMP_MILLI">
<code class="descname">TIMESTAMP_MILLI</code><em class="property"> = Type.TIMESTAMP_MILLI</em><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.TIMESTAMP_MILLI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.Schema.Type.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.Type.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.Schema.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Schema.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">types</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.SubStringLineFilter">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">SubStringLineFilter</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.SubStringLineFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.LineFilter" title="pyqstrat.pyqstrat_cpp.LineFilter"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.LineFilter</span></code></a></p>
<p>A helper class that will check if a line matches any of a set of strings</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.SubStringLineFilter.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.SubStringLineFilter.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>str</em>) – We check if any of the patterns are present in this string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Whether any of the patterns were present</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.SubStringLineFilter.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.SubStringLineFilter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>patterns</strong> (<em>list of str</em>) – The list of strings to match against</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextFileDecompressor">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextFileDecompressor</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextFileDecompressor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordGenerator" title="pyqstrat.pyqstrat_cpp.RecordGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordGenerator</span></code></a></p>
<p>A helper function that takes a filename and its compression type, and returns a function that we can use to iterate over lines in that file</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextFileDecompressor.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextFileDecompressor.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) – The file to read</li>
<li><strong>compression</strong> (<em>str</em>) – One of “” for uncompressed files, “gzip”, “bz2” or “lzip”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A function that takes an empty string as input, and fills in that string.  The function should return False EOF has been reached, True otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextFileDecompressor.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextFileDecompressor.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextFileProcessor">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextFileProcessor</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextFileProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.FileProcessor" title="pyqstrat.pyqstrat_cpp.FileProcessor"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.FileProcessor</span></code></a></p>
<p>A helper class that takes text based market data files and creates parsed and aggregated quote, trade, open interest, and other files from them.</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextFileProcessor.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextFileProcessor.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_filename</strong> (<em>str</em>) – The file to read</li>
<li><strong>compression</strong> (<em>str</em>) – One of “” for uncompressed files, “gzip”, “bz2” or “lzip”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Number of lines processed</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextFileProcessor.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextFileProcessor.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>record_generator</strong> – A function that takes a filename and its compression type, and returns a function that we
can use to iterate over lines in that file</li>
<li><strong>line_filter</strong> – A function that takes a line (str) as input and returns whether we should parse it or discard it</li>
<li><strong>record_parser</strong> – A function that takes a line (str) as input and returns a <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Record</span></code></a> object</li>
<li><strong>bad_line_handler</strong> – A function that takes a line that failed to parse and returns a <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Record</span></code></a> object or None</li>
<li><strong>record_filter</strong> – A function that takes a parsed Record object and returns whether we should keep it or discard it</li>
<li><strong>missing_data_handler</strong> – A function that takes a parsed Record object and deals with missing data, for example, by converting 0’s to NANs</li>
<li><strong>aggregators</strong> – A vector of functions that each take a parsed Record object and aggregate it.</li>
<li><strong>skip_rows</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of rows to skip in the file before starting to read it.  Defaults to 1 to ignore a header line</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextOpenInterestParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextOpenInterestParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextOpenInterestParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser" title="pyqstrat.pyqstrat_cpp.RecordFieldParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordFieldParser</span></code></a></p>
<p>Helper class that parses an open interest record from a list of fields (strings)</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextOpenInterestParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextOpenInterestParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fields</strong> (<em>list of str</em>) – A list of fields representing the record</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">or None if this record is not an open interest record</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyqstrat.pyqstrat_cpp.OpenInterestRecord" title="pyqstrat.pyqstrat_cpp.OpenInterestRecord">OpenInterestRecord</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextOpenInterestParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextOpenInterestParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>is_open_interest</strong> – A function that takes a list of strings as input and returns a bool if the fields represent an open interest record</li>
<li><strong>base_date</strong> (<em>int</em>) – If the timestamp in the files does not have a date component, pass in the date as number of millis or micros since the epoch</li>
<li><strong>timestamp_indices</strong> (<em>list of int</em>) – Index of the timestamp fields within the record.  For example, date and time could be in different fields.
We add the result of each timestamp field to get the final timestamp</li>
<li><strong>qty_idx</strong> (<em>int</em>) – Index of the quote size field</li>
<li><strong>id_field_indices</strong> (<em>list of str</em>) – Indices of the fields identifying an instrument.  For example, for a future this could be symbol and expiry.
These fields will be concatenated with a separator and placed in the id field in the record</li>
<li><strong>meta_field_indices</strong> (<em>list of str</em>) – Indices of additional fields you want to store.  For example, the exchange.</li>
<li><strong>timestamp_parsers</strong> – A list of function that takes a timestamp as a string and returns number of millis or micros since the epoch</li>
<li><strong>strip_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to strip any whitespace from the id fields before concatenating them.  Defaults to True</li>
<li><strong>strip_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to strip any whitespace from the meta fields before concatenating them.  Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextOtherParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextOtherParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextOtherParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser" title="pyqstrat.pyqstrat_cpp.RecordFieldParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordFieldParser</span></code></a></p>
<p>Helper class that parses a record that contains information other than a quote, trade or open interest record</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextOtherParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextOtherParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fields</strong> (<em>list of str</em>) – a list of fields representing the record</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyqstrat.pyqstrat_cpp.OtherRecord" title="pyqstrat.pyqstrat_cpp.OtherRecord">OtherRecord</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextOtherParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextOtherParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>is_other</strong> – A function that takes a list of strings as input and returns a bool if we want to parse this record</li>
<li><strong>base_date</strong> (<em>int</em>) – If the timestamp in the files does not have a date component, pass in the date as number of millis or micros since the epoch</li>
<li><strong>timestamp_indices</strong> (<em>list of int</em>) – Index of the timestamp fields within the record.  For example, date and time could be in different fields.
We add the result of each timestamp field to get the final timestamp</li>
<li><strong>id_field_indices</strong> (<em>list of str</em>) – Indices of the fields identifying an instrument.  For example, for a future this could be symbol and expiry.
These fields will be concatenated with a separator and placed in the id field in the record</li>
<li><strong>meta_field_indices</strong> (<em>list of str</em>) – Indices of additional fields you want to store.  For example, the exchange.</li>
<li><strong>timestamp_parsers</strong> – A list of functions that take a timestamp as a string and returns number of millis or micros since the epoch</li>
<li><strong>strip_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to strip any whitespace from the id fields before concatenating them.  Defaults to True</li>
<li><strong>strip_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to strip any whitespace from the meta fields before concatenating them.  Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextQuotePairParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextQuotePairParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextQuotePairParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser" title="pyqstrat.pyqstrat_cpp.RecordFieldParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordFieldParser</span></code></a></p>
<p>Helper class that parses a quote containing bid / ask in the same record from a list of fields (strings)</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextQuotePairParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextQuotePairParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fields</strong> (<em>list of str</em>) – A list of fields representing the record</li>
<li><strong>Returns</strong> – </li>
<li><strong>QuotePairRecord</strong> – Or None if this field is not a quote pair</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextQuotePairParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextQuotePairParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>is_quote_pair</strong> – a function that takes a list of strings as input and returns a bool if the fields represent a quote pair</li>
<li><strong>base_date</strong> (<em>int</em>) – if the timestamp in the files does not have a date component, pass in the date as number of millis or micros since the epoch</li>
<li><strong>timestamp_indices</strong> (<em>list of int</em>) – Index of the timestamp fields within the record.  For example, date and time could be in different fields.
We add the result of each timestamp field to get the final timestamp</li>
<li><strong>bid_price_idx</strong> (<em>int</em>) – index of the field that contains the bid price</li>
<li><strong>bid_qty_idx</strong> (<em>int</em>) – index of the field that contains the bid quantity</li>
<li><strong>ask_price_idx</strong> (<em>int</em>) – index of the field that contains the ask price</li>
<li><strong>ask_qty_idx</strong> (<em>int</em>) – index of the field that contains the ask quantity</li>
<li><strong>id_field_indices</strong> (<em>list of str</em>) – indices of the fields identifying an instrument.  For example, for a future this could be symbol and expiry. These fields will be concatenated with a separator and placed in the id field in the record.</li>
<li><strong>meta_field_indices</strong> (<em>list of str</em>) – indices of additional fields you want to store.  For example, the exchange.</li>
<li><strong>timestamp_parsers</strong> – a list of functions that takes a timestamp as a string and returns number of millis or micros since the epoch</li>
<li><strong>price_multiplier</strong> – (float, optional): sometimes the price in a file could be in hundredths of cents, and we divide by this to get dollars. Defaults to 1.0</li>
<li><strong>strip_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – if we want to strip any whitespace from the id fields before concatenating them.  Defaults to True</li>
<li><strong>strip_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – if we want to strip any whitespace from the meta fields before concatenating them.  Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextQuoteParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextQuoteParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextQuoteParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser" title="pyqstrat.pyqstrat_cpp.RecordFieldParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordFieldParser</span></code></a></p>
<p>Helper class that parses a quote from a list of fields (strings)</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextQuoteParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextQuoteParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fields</strong> (<em>list of str</em>) – A list of fields representing the record</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Or None if this field is not a quote</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyqstrat.pyqstrat_cpp.QuoteRecord" title="pyqstrat.pyqstrat_cpp.QuoteRecord">QuoteRecord</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextQuoteParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextQuoteParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>is_quote</strong> – a function that takes a list of strings as input and returns a bool if the fields represent a quote</li>
<li><strong>base_date</strong> (<em>int</em>) – if the timestamp in the files does not have a date component, pass in the date as number of millis or micros since the epoch</li>
<li><strong>timestamp_indices</strong> (<em>list of int</em>) – index of the timestamp field within the record</li>
<li><strong>bid_offer_idx</strong> (<em>int</em>) – index of the field that contains whether this is a bid or offer quote</li>
<li><strong>price_idx</strong> (<em>int</em>) – index of the price field</li>
<li><strong>qty_idx</strong> (<em>int</em>) – index of the quote size field</li>
<li><strong>id_field_indices</strong> (<em>list of str</em>) – indices of the fields identifying an instrument.  For example, for a future this could be symbol and expiry.
These fields will be concatenated with a separator and placed in the id field in the record</li>
<li><strong>meta_field_indices</strong> (<em>list of str</em>) – indices of additional fields you want to store.  For example, the exchange.</li>
<li><strong>timestamp_parsers</strong> – a vector of functions that take a timestamp as a string and returns number of millis or micros since the epoch</li>
<li><strong>bid_str</strong> (<em>str</em>) – if the field indicated in bid_offer_idx matches this string, we consider this quote to be a bid</li>
<li><strong>offer_str</strong> (<em>str</em>) – if the field indicated in bid_offer_idx matches this string, we consider this quote to be an offer</li>
<li><strong>price_multiplier</strong> – (float, optional): sometimes the price in a file could be in hundredths of cents, and we divide by this to get dollars.
Defaults to 1.0</li>
<li><strong>strip_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – if we want to strip any whitespace from the id fields before concatenating them.  Defaults to True</li>
<li><strong>strip_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – if we want to strip any whitespace from the meta fields before concatenating them.  Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextRecordParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextRecordParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextRecordParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordParser" title="pyqstrat.pyqstrat_cpp.RecordParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordParser</span></code></a></p>
<p>A helper class that takes in a text line, separates it into a list of fields based on a delimiter, and then uess the parsers
passed in to try and parse the line as a quote, trade, open interest record or any other type of record</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextRecordParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextRecordParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parsers</strong> – A vector of functions that each take a list of strings as input and returns a subclass of <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Record</span></code></a> or None</li>
<li><strong>exclusive</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set this when each line can only contain one type of record, after one first parser returns a non
None object, we will not call other parsers.  Default false</li>
<li><strong>separator</strong> (<em>str</em><em>, </em><em>optional</em>) – A single character string.  This is the delimiter we use to separate fields from the text passed in.
Default ,</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TextTradeParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TextTradeParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextTradeParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.RecordFieldParser" title="pyqstrat.pyqstrat_cpp.RecordFieldParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.RecordFieldParser</span></code></a></p>
<p>Helper class that parses a trade from a list of fields (strings)</p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextTradeParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextTradeParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fields</strong> (<em>list of str</em>) – A list of fields representing the record</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">or None if this record is not a trade</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyqstrat.pyqstrat_cpp.TradeRecord" title="pyqstrat.pyqstrat_cpp.TradeRecord">TradeRecord</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TextTradeParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TextTradeParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>is_trade</strong> – A function that takes a list of strings as input and returns a bool if the fields represent a trade</li>
<li><strong>base_date</strong> (<em>int</em>) – If the timestamp in the files does not have a date component, pass in the date as number of millis or micros since the epoch</li>
<li><strong>timestamp_indices</strong> (<em>list of int</em>) – Index of the timestamp fields within the record.  For example, date and time could be in different fields.
We add the result of each timestamp field to get the final timestamp</li>
<li><strong>price_idx</strong> (<em>int</em>) – Index of the price field</li>
<li><strong>qty_idx</strong> (<em>int</em>) – Index of the quote size field</li>
<li><strong>id_field_indices</strong> (<em>list of str</em>) – Indices of the fields identifying an instrument.  For example, for a future this could be symbol and expiry.
These fields will be concatenated with a separator and placed in the id field in the record</li>
<li><strong>meta_field_indices</strong> (<em>list of str</em>) – Indices of additional fields you want to store.  For example, the exchange.</li>
<li><strong>timestamp_parsers</strong> – A list of functions that takes a timestamp as a string and returns number of millis or micros since the epoch</li>
<li><strong>price_multiplier</strong> – (float, optional): Sometimes the price in a file could be in hundredths of cents, and we divide by this to get dollars.
Defaults to 1.0</li>
<li><strong>strip_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to strip any whitespace from the id fields before concatenating them.  Defaults to True</li>
<li><strong>strip_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to strip any whitespace from the meta fields before concatenating them.  Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TimestampParser">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TimestampParser</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TimestampParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TimestampParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TimestampParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TimestampParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TimestampParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TradeBarAggregator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TradeBarAggregator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeBarAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Aggregator" title="pyqstrat.pyqstrat_cpp.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Aggregator</span></code></a></p>
<dl class="docutils">
<dt>Aggregate trade records to create trade bars, given a frequency.  Calculates open, high, low, close, volume, vwap as well as last_update_time</dt>
<dd>which is timestamp of the last trade that we processed before the bar ended.</dd>
</dl>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TradeBarAggregator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeBarAggregator.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a trade record to be written to disk at some point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trade</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.TradeRecord" title="pyqstrat.pyqstrat_cpp.TradeRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TradeRecord</span></code></a>) – </li>
<li><strong>line_number</strong> (<em>int</em>) – The line number of the source file that this trade came from.  Used for debugging</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TradeBarAggregator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeBarAggregator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer_creator</strong> – A function that takes an output_file_prefix, schema, create_batch_id and max_batch_size and returns an object
implementing the <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Writer" title="pyqstrat.pyqstrat_cpp.Writer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code></a> interface</li>
<li><strong>output_file_prefix</strong> (<em>str</em>) – Path of the output file to create.  The writer and aggregator may add suffixes to this to indicate the kind
of data and format the file creates.  E.g. “/tmp/output_file_1”</li>
<li><strong>frequency</strong> (<em>str</em><em>, </em><em>optional</em>) – A string like “5m” indicating the bar size is 5 mins.  Units can be s,m,h or d for second, minute, hour or day.
Defaults to “5m”</li>
<li><strong>batch_by_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we will create one batch for each id.  This will allow us to retrieve all records for a single
instrument by reading a single batch.  Defaults to True.</li>
<li><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If set, we will write a batch to disk every time we have this many records queued up.  Defaults to 2.1 billion</li>
<li><strong>timestamp_unit</strong> (<a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Schema.Type" title="pyqstrat.pyqstrat_cpp.Schema.Type"><em>Schema.Type</em></a><em>, </em><em>optional</em>) – Whether timestamps are measured as milliseconds or microseconds since the unix epoch.
Defaults to Schema.TIMESTAMP_MILLI</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TradeBarAggregator.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeBarAggregator.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush all unwritten records to the Writer, which writes them to disk when its close function is called</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">TradeRecord</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyqstrat.pyqstrat_cpp.Record" title="pyqstrat.pyqstrat_cpp.Record"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyqstrat.pyqstrat_cpp.Record</span></code></a></p>
<p>A parsed trade record that we can save to disk</p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord.id">
<code class="descname">id</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord.id" title="Permalink to this definition">¶</a></dt>
<dd><p>A unique string representing a symbol or instrument id</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord.timestamp">
<code class="descname">timestamp</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade time, in milliseconds or microseconds since 1/1/1970</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord.qty">
<code class="descname">qty</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord.qty" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade quantity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord.price">
<code class="descname">price</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord.price" title="Permalink to this definition">¶</a></dt>
<dd><p>Trade price</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord.metadata">
<code class="descname">metadata</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>a string representing any extra information you want to save, such as exchange, or special trade conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.TradeRecord.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.TradeRecord.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">id</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">metadata</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">price</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">qty</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">timestamp</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.Writer">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">Writer</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<p>An abstract class that you subclass to provide an object that can write to disk</p>
<dl class="attribute">
<dt id="pyqstrat.pyqstrat_cpp.Writer.__init__">
<code class="descname">__init__</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Writer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.Writer.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Writer.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the writer and flush any remaining data to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>success</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to False, we had some kind of exception and are cleaning up.  Tells the function to
not indicate the file was written successfully, for example by renaming a temp file to the actual filename.  Defaults to True</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.Writer.write_batch">
<code class="descname">write_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.Writer.write_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a batch of records to disk.  The batch can have an optional string id so we can
later retrieve just this batch of records without reading the whole file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_id</strong> (<em>str</em><em>, </em><em>optional</em>) – An identifier which can later be used to retrieve this batch from disk. Defaults to “”</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.WriterCreator">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">WriterCreator</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.WriterCreator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.WriterCreator.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.WriterCreator.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.WriterCreator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.WriterCreator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.black_scholes_price">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">black_scholes_price</code><span class="sig-paren">(</span><em>call: numpy.ndarray[bool], S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.black_scholes_price" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Euroepean option price
:param call: True for a call option, False for a put
:type call: bool
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Option price</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.cdf">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">cdf</code><span class="sig-paren">(</span><em>x: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.cdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Cumulative density function of normal distribution
:param x: random variable
:type x: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">cdf of the random variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.d1">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">d1</code><span class="sig-paren">(</span><em>S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.d1" title="Permalink to this definition">¶</a></dt>
<dd><p>d1 from Black Scholes
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.d2">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">d2</code><span class="sig-paren">(</span><em>S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.d2" title="Permalink to this definition">¶</a></dt>
<dd><p>d2 from Black Scholes
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.delta">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">delta</code><span class="sig-paren">(</span><em>call: numpy.ndarray[bool], S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute European option delta
:param call: True for a call option, False for a put
:type call: bool
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Option delta</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.gamma">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">gamma</code><span class="sig-paren">(</span><em>S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute European option gamma.
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Option gamma</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.implied_vol">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">implied_vol</code><span class="sig-paren">(</span><em>call: numpy.ndarray[bool], price: numpy.ndarray[float64], S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.implied_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute implied volatility for a European option.
:param call: True for a call option, False for a put
:type call: bool
:param price: The option premium
:type price: float
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Implied volatility.  For 1% we return 0.01</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="pyqstrat.pyqstrat_cpp.ostream_redirect">
<em class="property">class </em><code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">ostream_redirect</code><a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ostream_redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<dl class="method">
<dt id="pyqstrat.pyqstrat_cpp.ostream_redirect.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>self: pyqstrat.pyqstrat_cpp.ostream_redirect</em>, <em>stdout: bool=True</em>, <em>stderr: bool=True</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.ostream_redirect.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.rho">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">rho</code><span class="sig-paren">(</span><em>call: numpy.ndarray[bool], S: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute European option rho.  This is Black Scholes formula rho divided by 100 so we get rho per 1% change in interest rate
:param call: True for a European call option, False for a put
:type call: bool
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Option theta</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.theta">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">theta</code><span class="sig-paren">(</span><em>call: numpy.ndarray[bool], F: numpy.ndarray[float64], K: numpy.ndarray[float64], t: numpy.ndarray[float64], r: numpy.ndarray[float64], sigma: numpy.ndarray[float64], q: numpy.ndarray[float64]</em><span class="sig-paren">)</span> &#x2192; object<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute European option theta per day.  This is Black Scholes formula theta divided by 365 to give us the customary theta per day
:param call: True for a call option, False for a put
:type call: bool
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Option theta</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.pyqstrat_cpp.vega">
<code class="descclassname">pyqstrat.pyqstrat_cpp.</code><code class="descname">vega</code><span class="sig-paren">(</span><em>S: float</em>, <em>K: float</em>, <em>t: float</em>, <em>r: float</em>, <em>sigma: float</em>, <em>q: float</em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#pyqstrat.pyqstrat_cpp.vega" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute European option vega.  This is Black Scholes formula vega divided by 100 so we get rho per 1% change in interest rate
:param S: Spot price. For a future discount the future price using exp(-rt)
:type S: float
:param K: Strike
:type K: float
:param t: Time to maturity in years
:type t: float
:param r: Continuously compounded interest rate.  Use 0.01 for 1%
:type r: float
:param sigma: Annualized volatility.  Use 0.01 for 1%
:type sigma: float
:param q: Annualized dividend yield.  Use 0.01 for 1%
:type q: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Option vega</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyqstrat.marketdata_processor">
<span id="pyqstrat-marketdata-processor-module"></span><h2>pyqstrat.marketdata_processor module<a class="headerlink" href="#module-pyqstrat.marketdata_processor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.marketdata_processor.PathFileNameProvider">
<em class="property">class </em><code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">PathFileNameProvider</code><span class="sig-paren">(</span><em>path</em>, <em>include_pattern=None</em>, <em>exclude_pattern=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#PathFileNameProvider"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.PathFileNameProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A helper class that, given a pattern such as such as “/tmp/abc*.gz” and an optional include and exclude pattern,
returns names of all files that match</p>
<dl class="method">
<dt id="pyqstrat.marketdata_processor.PathFileNameProvider.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#PathFileNameProvider.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.PathFileNameProvider.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">all matching filenames</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list of str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.marketdata_processor.PathFileNameProvider.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>path</em>, <em>include_pattern=None</em>, <em>exclude_pattern=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#PathFileNameProvider.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.PathFileNameProvider.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) – A pattern such as “/tmp/abc*.gz”</li>
<li><strong>include_pattern</strong> (<em>str</em>) – Given a pattern such as “xzy”, will return only filenames that contain xyz</li>
<li><strong>exclude_pattern</strong> (<em>str</em>) – Given a pattern such as “_tmp”, will exclude all filenames containing _tmp</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.marketdata_processor.SingleDirectoryFileNameMapper">
<em class="property">class </em><code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">SingleDirectoryFileNameMapper</code><span class="sig-paren">(</span><em>output_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#SingleDirectoryFileNameMapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.SingleDirectoryFileNameMapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A helper class that provides a mapping from input filenames to their corresponding output filenames in an output directory.</p>
<dl class="method">
<dt id="pyqstrat.marketdata_processor.SingleDirectoryFileNameMapper.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>input_filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#SingleDirectoryFileNameMapper.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.SingleDirectoryFileNameMapper.__call__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_filepath</strong> (<em>str</em>) – The input file that we are creating an output file for, e.g. “/home/xzy.gz”</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>Output file path for that input.  We take the filename from the input filepath, strip out any extension</dt>
<dd>and prepend the output directory name</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.marketdata_processor.SingleDirectoryFileNameMapper.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>output_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#SingleDirectoryFileNameMapper.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.SingleDirectoryFileNameMapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>output_dir</strong> (<em>str</em>) – The directory where we want to write output files</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyqstrat.marketdata_processor.TextHeaderParser">
<em class="property">class </em><code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">TextHeaderParser</code><span class="sig-paren">(</span><em>record_generator</em>, <em>skip_rows=0</em>, <em>separator='</em>, <em>'</em>, <em>make_lowercase=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#TextHeaderParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.TextHeaderParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parses column headers from a text file containing market data</p>
<dl class="method">
<dt id="pyqstrat.marketdata_processor.TextHeaderParser.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>input_filename</em>, <em>compression</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#TextHeaderParser.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.TextHeaderParser.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Args:</p>
<p>input_filename (str): The file to read
compression (str): Compression type, e.g. “gzip”, or None if the file is not compressed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">column headers</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list of str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.marketdata_processor.TextHeaderParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>record_generator</em>, <em>skip_rows=0</em>, <em>separator='</em>, <em>'</em>, <em>make_lowercase=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#TextHeaderParser.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.TextHeaderParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>record_generator</strong> – A function that takes a filename and its compression type and returns an object
that we can use to iterate through lines in that file</li>
<li><strong>skip_rows</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of rows to skip before starting to read the file.  Default is 0</li>
<li><strong>separator</strong> (<em>str</em><em>, </em><em>optional</em>) – Separator for headers.  Defaults to ,</li>
<li><strong>make_lowercase</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to convert headers to lowercase before returning them</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.marketdata_processor.base_date_filename_mapper">
<code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">base_date_filename_mapper</code><span class="sig-paren">(</span><em>input_file_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#base_date_filename_mapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.base_date_filename_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper function that parses out the date from a filename.  For example, given a file such as “/tmp/spx_2018-08-09”, this parses out the
date part of the filename and returns milliseconds (no fractions) since the epoch to that date.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_filepath</strong> (<em>str</em>) – Full path to the input file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Milliseconds since unix epoch to the date implied by that file</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">base_date_filename_mapper</span><span class="p">(</span><span class="s2">&quot;/tmp/spy_1970-1-2_quotes.gz&quot;</span><span class="p">)</span>
<span class="go">86400000</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.marketdata_processor.create_text_file_processor">
<code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">create_text_file_processor</code><span class="sig-paren">(</span><em>record_generator</em>, <em>line_filter</em>, <em>record_parser</em>, <em>bad_line_handler</em>, <em>record_filter</em>, <em>missing_data_handler</em>, <em>aggregators</em>, <em>skip_rows=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#create_text_file_processor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.create_text_file_processor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyqstrat.marketdata_processor.get_field_indices">
<code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">get_field_indices</code><span class="sig-paren">(</span><em>field_names</em>, <em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#get_field_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.get_field_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to get indices of field names in a list of headers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>field_names</strong> (<em>list of str</em>) – The fields we want indices of</li>
<li><strong>headers</strong> (<em>list of str</em>) – All headers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">indices of each field name in the headers list</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.marketdata_processor.process_marketdata">
<code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">process_marketdata</code><span class="sig-paren">(</span><em>input_filename_provider</em>, <em>file_processor</em>, <em>num_processes=None</em>, <em>raise_on_error=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#process_marketdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.process_marketdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Top level function to process a set of market data files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_filename_provider</strong> – A function that returns a list of filenames (incl path) we need to process.</li>
<li><strong>file_processor</strong> – A function that takes an input filename and processes it, returning number of lines processed.</li>
<li><strong>num_processes</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of processes to run to parse these files.  If set to None, we use the number of cores
present on your machine.  Defaults to None</li>
<li><strong>raise_on_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, we raise an exception when there is a problem with parsing a file, so we can see a stack
trace and diagnose the problem.  If not set, we print the error and continue.  Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.marketdata_processor.process_marketdata_file">
<code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">process_marketdata_file</code><span class="sig-paren">(</span><em>input_filename</em>, <em>output_file_prefix_mapper</em>, <em>record_parser_creator</em>, <em>aggregator_creator</em>, <em>line_filter=None</em>, <em>compression=None</em>, <em>base_date_mapper=None</em>, <em>file_processor_creator=&lt;function create_text_file_processor&gt;</em>, <em>header_parser_creator=&lt;function &lt;lambda&gt;&gt;</em>, <em>header_record_generator=&lt;function text_file_record_generator&gt;</em>, <em>record_generator=&lt;pyqstrat.pyqstrat_cpp.TextFileDecompressor object&gt;</em>, <em>bad_line_handler=&lt;pyqstrat.pyqstrat_cpp.PrintBadLineHandler object&gt;</em>, <em>record_filter=None</em>, <em>missing_data_handler=&lt;pyqstrat.pyqstrat_cpp.PriceQtyMissingDataHandler object&gt;</em>, <em>writer_creator=&lt;pyqstrat.pyqstrat_cpp.ArrowWriterCreator object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#process_marketdata_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.process_marketdata_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Processes a single market data file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_filename</strong> (<em>str</em>) – </li>
<li><strong>output_file_prefix_mapper</strong> – A function that takes an input filename and returns the corresponding output filename we want</li>
<li><strong>record_parser_creator</strong> – A function that takes a date and a list of column names and returns a
function that can take a list of fields and return a subclass of Record</li>
<li><strong>line_filter</strong> (<em>optional</em>) – A function that takes a line and decides whether we want to keep it or discard it.  Defaults to None</li>
<li><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – Compression type for the input file.  Defaults to None</li>
<li><strong>base_date_mapper</strong> (<em>optional</em>) – A function that takes an input filename and returns the date implied by the filename,
represented as millis since epoch.  Defaults to helper <code class="xref py py-obj docutils literal notranslate"><span class="pre">function</span> <span class="pre">base_date_filename_mapper</span></code></li>
<li><strong>file_processor_creator</strong> (<em>optional</em>) – A function that returns an object that we can use to iterate through lines in a file.  Defaults to
helper function <a class="reference internal" href="#pyqstrat.marketdata_processor.create_text_file_processor" title="pyqstrat.marketdata_processor.create_text_file_processor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_text_file_processor</span></code></a></li>
<li><strong>bad_line_handler</strong> (<em>optional</em>) – A function that takes a line that we could not parse, and either parses it or does something else
like recording debugging info, or stopping the processing by raising an exception.  Defaults to helper function
<code class="xref py py-obj docutils literal notranslate"><span class="pre">PrintBadLineHandler</span></code></li>
<li><strong>record_filter</strong> (<em>optional</em>) – A function that takes a parsed TradeRecord, QuoteRecord, OpenInterestRecord or OtherRecord and decides whether we
want to keep it or discard it.  Defaults to None</li>
<li><strong>missing_data_handler</strong> (<em>optional</em>) – A function that takes a parsed TradeRecord, QuoteRecord, OpenInterestRecord or OtherRecord, and decides
deals with any data that is missing in those records.  For example, 0 for bid could be replaced by NAN.  Defaults to helper function:
<code class="xref py py-obj docutils literal notranslate"><span class="pre">price_qty_missing_data_handler</span></code></li>
<li><strong>writer_creator</strong> (<em>optional</em>) – A function that takes an output_file_prefix, schema, whether to create a batch id file, and batch_size
and returns a subclass of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Writer</span></code>.  Defaults to helper function: <code class="xref py py-obj docutils literal notranslate"><span class="pre">arrow_writer_creator</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.marketdata_processor.text_file_record_generator">
<code class="descclassname">pyqstrat.marketdata_processor.</code><code class="descname">text_file_record_generator</code><span class="sig-paren">(</span><em>filename</em>, <em>compression</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/marketdata_processor.html#text_file_record_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.marketdata_processor.text_file_record_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper function that returns an object that we can use to iterate through lines in the input file
:param filename: The input filename
:type filename: str
:param compression: The compression type of the input file or None if its not compressed
:type compression: str</p>
</dd></dl>

</div>
<div class="section" id="module-pyqstrat.trade_bars">
<span id="pyqstrat-trade-bars-module"></span><h2>pyqstrat.trade_bars module<a class="headerlink" href="#module-pyqstrat.trade_bars" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyqstrat.trade_bars.TradeBars">
<em class="property">class </em><code class="descclassname">pyqstrat.trade_bars.</code><code class="descname">TradeBars</code><span class="sig-paren">(</span><em>timestamps</em>, <em>c</em>, <em>o=None</em>, <em>h=None</em>, <em>l=None</em>, <em>v=None</em>, <em>vwap=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Used to store OHLCV bars.  You must at least supply timestamps and close prices.  All other fields are optional.</p>
<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.timestamp">
<code class="descname">timestamp</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy datetime array with the datetime for each bar.  Must be monotonically increasing.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.c">
<code class="descname">c</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.c" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy float array with close prices for the bar.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.o">
<code class="descname">o</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.o" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy float array with open prices . Default None</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.h">
<code class="descname">h</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.h" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy float array with high prices. Default None</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.l">
<code class="descname">l</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.l" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy float array with high prices. Default None</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.v">
<code class="descname">v</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.v" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy integer array with volume for the bar. Default None</p>
</dd></dl>

<dl class="attribute">
<dt id="pyqstrat.trade_bars.TradeBars.vwap">
<code class="descname">vwap</code><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.vwap" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy float array with the volume weighted average price for the bar.  Default None</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>timestamps</em>, <em>c</em>, <em>o=None</em>, <em>h=None</em>, <em>l=None</em>, <em>v=None</em>, <em>vwap=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeroes in o, h, l, c are set to nan</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.add_timestamps">
<code class="descname">add_timestamps</code><span class="sig-paren">(</span><em>timestamps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.add_timestamps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.add_timestamps" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds new timestamps to a market data object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timestamps</strong> (<em>np.array of np.datetime64</em>) – New timestamps to add.  Does not have to be sorted or unique</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-10&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[ns]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.1</span><span class="p">,</span> <span class="mf">8.2</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trade_bar</span> <span class="o">=</span> <span class="n">TradeBars</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-01-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-09&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[ns]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trade_bar</span><span class="o">.</span><span class="n">add_timestamps</span><span class="p">(</span><span class="n">new_timestamps</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">trade_bar</span><span class="o">.</span><span class="n">timestamps</span><span class="p">)</span>
<span class="go">[&#39;2018-01-05T00:00:00.000000000&#39; &#39;2018-01-07T00:00:00.000000000&#39;</span>
<span class="go"> &#39;2018-01-09T00:00:00.000000000&#39; &#39;2018-01-10T00:00:00.000000000&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;float&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{x:.4f}</span><span class="s1">&#39;</span><span class="p">})</span>  <span class="c1"># After numpy 1.13 positive floats don&#39;t have a leading space for sign</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">trade_bar</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="n">trade_bar</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
<span class="go">[9.0000 nan 10.0000 11.0000] [8.1000 nan 8.2000 8.3000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.describe">
<code class="descname">describe</code><span class="sig-paren">(</span><em>warn_std=10</em>, <em>time_distribution_frequency='15 min'</em>, <em>print_time_distribution=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.describe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Describe the bars.  Shows an overview, errors and warnings for the bar data.  This is a good function to use
before running any backtests on a set of bar data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>warn_std</strong> – See warning function</li>
<li><strong>time_distribution_frequency</strong> – See time_distribution function</li>
<li><strong>print_time_distribution</strong> – Whether to print the time distribution in addition to plotting it.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.df">
<code class="descname">df</code><span class="sig-paren">(</span><em>start_date=None</em>, <em>end_date=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.df" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.errors">
<code class="descname">errors</code><span class="sig-paren">(</span><em>display=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe indicating any highs that are lower than opens, closes, lows or lows that are higher than other columns
Also includes any ohlcv values that are negative</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.freq_str">
<code class="descname">freq_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.freq_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.freq_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.has_ohlc">
<code class="descname">has_ohlc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.has_ohlc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.has_ohlc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if we have all ohlc columns and none are empty</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.overview">
<code class="descname">overview</code><span class="sig-paren">(</span><em>display=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.overview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.overview" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe showing basic information about the data, including count, number and percent missing, min, max</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>display</strong> – Whether to print out the warning dataframe as well as returning it</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>figsize=(15</em>, <em>8)</em>, <em>date_range=None</em>, <em>sampling_frequency=None</em>, <em>title='Price / Volume'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a candlestick or line plot depending on whether we have ohlc data or just close prices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>figsize</strong> – Size of the figure (default (15,8))</li>
<li><strong>date_range</strong> – A tuple of strings or numpy datetimes for plotting a smaller sample of the data, e.g. (“2018-01-01”, “2018-01-06”)</li>
<li><strong>sampling_frequency</strong> – Downsample before plotting.  See pandas frequency strings for possible values.</li>
<li><strong>title</strong> – Title of the graph, default “Price / Volume”</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>sampling_frequency</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.resample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample the trade bars data into a new bar frequency</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sampling_frequency</strong> – See sampling frequency in pandas</li>
<li><strong>inplace</strong> – If set to False, don’t modify this object, return a new object instead.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.time_distribution">
<code class="descname">time_distribution</code><span class="sig-paren">(</span><em>frequency='15 minutes'</em>, <em>display=True</em>, <em>plot=True</em>, <em>figsize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.time_distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.time_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataframe with the time distribution of the bars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frequency</strong> – The width of each bin (default “15 minutes”).  You can use hours or days as well.</li>
<li><strong>display</strong> – Whether to display the data in addition to returning it.</li>
<li><strong>plot</strong> – Whether to plot the data in addition to returning it.</li>
<li><strong>figsize</strong> – If plot is set, optional figure size for the plot (default (20,8))</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.valid_row">
<code class="descname">valid_row</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.valid_row"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.valid_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the row with index i has no nans in it.</p>
</dd></dl>

<dl class="method">
<dt id="pyqstrat.trade_bars.TradeBars.warnings">
<code class="descname">warnings</code><span class="sig-paren">(</span><em>warn_std=10</em>, <em>display=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#TradeBars.warnings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.TradeBars.warnings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dataframe indicating any values where the bar over bar change is more than warn_std standard deviations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>warn_std</strong> – Number of standard deviations to use as a threshold (default 10)</li>
<li><strong>display</strong> – Whether to print out the warning dataframe as well as returning it</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyqstrat.trade_bars.roll_futures">
<code class="descclassname">pyqstrat.trade_bars.</code><code class="descname">roll_futures</code><span class="sig-paren">(</span><em>fut_prices</em>, <em>date_func</em>, <em>condition_func</em>, <em>expiries=None</em>, <em>return_full_df=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#roll_futures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.roll_futures" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a continuous futures dataframe with one row per datetime given rolling logic</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>md</strong> – A dataframe containing the columns ‘date’, ‘series’, and any other market data, for example, ohlcv data. Date can contain time for sub-daily bars.
The series column must contain a different string name for each futures series, e.g. SEP2018, DEC2018, etc.</li>
<li><strong>date_func</strong> – A function that takes the market data object as an input and returns a numpy array of booleans
True indicates that the future should be rolled on this date if the condition specified in condition_func is met.
This function can assume that we have all the columns in the original market data object plus the same columns suffixed with _next for the potential series
to roll over to.</li>
<li><strong>condition_func</strong> – A function that takes the market data object as input and returns a numpy array of booleans.
True indicates that we should try to roll the future at that row.</li>
<li><strong>expiries</strong> – An optional dataframe with 2 columns, ‘series’ and ‘expiry’.  This should have one row per future series indicating that future’s expiry date.
If you don’t pass this in, the function will assume that the expiry column is present in the original dataframe.</li>
<li><strong>return_full_df</strong> – If set, will return the datframe without removing extra timestamps so you can use your own logic for rolling, including the _next columns and
the roll flag</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>A pandas DataFrame with one row per date, which contains the columns in the original md DataFrame and the same columns suffixed with _next</dt>
<dd><p class="first last">representing the series we want to roll to.  There is also a column called roll_flag which is set to True whenever
the date and roll condition functions are met.</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fut_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;timestamp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-11&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-16&#39;</span><span class="p">)),</span>
<span class="gp">... </span>                                          <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-11&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-16&#39;</span><span class="p">)))),</span>
<span class="gp">... </span>                  <span class="s1">&#39;c&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">,</span> <span class="mf">10.4</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">10.35</span><span class="p">,</span> <span class="mf">10.45</span><span class="p">,</span> <span class="mf">10.55</span><span class="p">,</span> <span class="mf">10.65</span><span class="p">,</span> <span class="mf">10.75</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="s1">&#39;v&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="s1">&#39;series&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MAR2018&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;JUN2018&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span><span class="p">})[[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expiries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2018-03-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-06-15&#39;</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;M8[D]&#39;</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAR2018&#39;</span><span class="p">,</span> <span class="s1">&#39;JUN2018&#39;</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;expiry&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">fut_prices</span> <span class="p">:</span> <span class="n">fut_prices</span><span class="o">.</span><span class="n">expiry</span> <span class="o">-</span> <span class="n">fut_prices</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">condition_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">fut_prices</span> <span class="p">:</span> <span class="n">fut_prices</span><span class="o">.</span><span class="n">v_next</span> <span class="o">&gt;</span> <span class="n">fut_prices</span><span class="o">.</span><span class="n">v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">roll_futures</span><span class="p">(</span><span class="n">fut_prices</span><span class="p">,</span> <span class="n">date_func</span><span class="p">,</span> <span class="n">condition_func</span><span class="p">,</span> <span class="n">expiries</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="s1">&#39;MAR2018&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-14&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="s1">&#39;JUN2018&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-03-15&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyqstrat.trade_bars.sort_trade_bars">
<code class="descclassname">pyqstrat.trade_bars.</code><code class="descname">sort_trade_bars</code><span class="sig-paren">(</span><em>columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#sort_trade_bars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.sort_trade_bars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyqstrat.trade_bars.sort_trade_bars_key">
<code class="descclassname">pyqstrat.trade_bars.</code><code class="descname">sort_trade_bars_key</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#sort_trade_bars_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.sort_trade_bars_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyqstrat.trade_bars.test_trade_bars">
<code class="descclassname">pyqstrat.trade_bars.</code><code class="descname">test_trade_bars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyqstrat/trade_bars.html#test_trade_bars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyqstrat.trade_bars.test_trade_bars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyqstrat">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyqstrat" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pyqstrat</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyqstrat</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pyqstrat package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">pyqstrat</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">pyqstrat</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Sal Abbasi.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/pyqstrat.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>